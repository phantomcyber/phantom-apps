{
    "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
    "name": "Windows Remote Management",
    "description": "This app integrates with the Windows Remote Management service to execute various actions",
    "type": "endpoint",
    "product_vendor": "Microsoft",
    "logo": "logo_microsoft.svg",
    "logo_dark": "logo_microsoft_dark.svg",
    "product_name": "Windows Remote Management",
    "product_version_regex": ".*",
    "publisher": "Splunk",
    "license": "Copyright (c) 2018-2021 Splunk Inc.",
    "app_version": "2.0.0",
    "utctime_updated": "2020-12-22T07:23:12.000000Z",
    "package_name": "phantom_winrm",
    "main_module": "winrm_connector.py",
    "min_phantom_version": "4.9.39220",
    "python_version": "3",
    "latest_tested_versions": [
        "On-premise, Windows Server 2012 R2 Standard"
    ],
    "app_wizard_version": "1.0.0",
    "pip_dependencies": {
        "wheel": [
            {
                "module": "pywinrm",
                "input_file": "wheels/pywinrm-0.4.1-py2.py3-none-any.whl"
            },
            {
                "module": "requests_ntlm",
                "input_file": "wheels/requests_ntlm-1.1.0-py2.py3-none-any.whl"
            },
            {
                "module": "ntlm_auth",
                "input_file": "wheels/ntlm_auth-1.2.0-py2.py3-none-any.whl"
            }
        ]
    },
    "configuration": {
        "endpoint": {
            "description": "IP/Hostname (For TEST CONNECTIVITY and default, if not provided in an action)",
            "data_type": "string",
            "order": 0
        },
        "verify_server_cert": {
            "description": "Verify Server Certificate",
            "data_type": "boolean",
            "default": false,
            "order": 1
        },
        "default_protocol": {
            "description": "Default protocol for actions",
            "data_type": "string",
            "default": "http",
            "order": 2,
            "value_list": [
                "http",
                "https"
            ]
        },
        "default_port": {
            "description": "Default port for actions",
            "data_type": "numeric",
            "default": 5985,
            "order": 3
        },
        "domain": {
            "description": "Domain",
            "data_type": "string",
            "order": 4
        },
        "username": {
            "description": "Username",
            "data_type": "string",
            "required": true,
            "order": 5
        },
        "password": {
            "description": "Password",
            "data_type": "password",
            "required": true,
            "order": 6
        },
        "transport": {
            "description": "Type of transport to use",
            "data_type": "string",
            "required": true,
            "value_list": [
                "basic",
                "ntlm"
            ],
            "default": "basic",
            "order": 7
        }
    },
    "actions": [
        {
            "action": "test connectivity",
            "description": "Validate the asset configuration for connectivity using supplied configuration",
            "type": "test",
            "identifier": "test_connectivity",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "run command",
            "description": "Execute a command on the endpoint",
            "verbose": "Unless you implement a custom parser, this action will always succeed regardless of the input. Either a <b>command</b> or pair of <b>command_id</b> and <b>shell_id</b> must be specified. If a <b>command_id</b> is present, all other parameters will be ignored. <p><b>Note:</b> The command_id and shell_id you provide to fetch the output can only be used once because once the output is fetched successfully server will remove output from its cache.</p>",
            "type": "generic",
            "identifier": "run_command",
            "read_only": false,
            "parameters": {
                "command": {
                    "description": "The command to be run",
                    "data_type": "string",
                    "order": 1
                },
                "arguments": {
                    "description": "The arguments for the command",
                    "data_type": "string",
                    "order": 2
                },
                "parser": {
                    "description": "The vault ID of a custom parser to use for output",
                    "contains": [
                        "vault id"
                    ],
                    "primary": true,
                    "data_type": "string",
                    "order": 3
                },
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                },
                "async": {
                    "description": "Start the command, but don't wait for output",
                    "data_type": "boolean",
                    "default": false,
                    "order": 4
                },
                "command_id": {
                    "description": "Command ID of async command (Provide with shell_id)",
                    "data_type": "string",
                    "primary": true,
                    "order": 5,
                    "contains": [
                        "winrm command id"
                    ]
                },
                "shell_id": {
                    "description": "Shell ID of async command (Provide with command_id)",
                    "data_type": "string",
                    "order": 6,
                    "contains": [
                        "winrm shell id"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.arguments",
                    "data_type": "string",
                    "example_values": [
                        "/all"
                    ]
                },
                {
                    "data_path": "action_result.parameter.async",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.parameter.command",
                    "data_type": "string",
                    "example_values": [
                        "ipconfig"
                    ]
                },
                {
                    "data_path": "action_result.parameter.command_id",
                    "data_type": "string",
                    "contains": [
                        "winrm command id"
                    ],
                    "example_values": [
                        "1AAA1111-1A11-11A1-1111-1A1AAA1A11A1"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.parameter.parser",
                    "data_type": "string",
                    "contains": [
                        "vault id"
                    ],
                    "example_values": [
                        "8afa5c86de9ea94ecfe5b4c0837d2543d0b20b56"
                    ]
                },
                {
                    "data_path": "action_result.parameter.shell_id",
                    "data_type": "string",
                    "contains": [
                        "winrm shell id"
                    ],
                    "example_values": [
                        "1AAA1111-1A11-11A1-1111-1A1AAA1A11A1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.status_code",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.std_err",
                    "data_type": "string",
                    "example_values": [
                        "Error message"
                    ]
                },
                {
                    "data_path": "action_result.data.*.std_out",
                    "data_type": "string",
                    "example_values": [
                        "Successful output"
                    ]
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "column_name": "Message",
                    "column_order": 0,
                    "example_values": [
                        "Successfully ran command"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.command_id",
                    "data_type": "string",
                    "contains": [
                        "winrm command id"
                    ],
                    "example_values": [
                        "1AAA1111-1A11-11A1-1111-1A1AAA1A11A1"
                    ]
                },
                {
                    "data_path": "action_result.summary.shell_id",
                    "data_type": "string",
                    "contains": [
                        "winrm shell id"
                    ],
                    "example_values": [
                        "1AAA1111-1A11-11A1-1111-1A1AAA1A11A1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "run script",
            "description": "Run a PowerShell script on the endpoint",
            "verbose": "The script you provide can either be in the vault, or it can just be a string of the script to run. If both values are present, it will use the <b>script_file</b> over the <b>script_str</b>. Unless you implement a custom parser, this action will always succeed regardless of the input. If <b>command_id</b> and <b>shell_id</b> are present, <b>script_file</b> and <b>script_str</b> will be ignored. This action will fail if at least one of <b>script_file</b>, <b>script_str</b>, or the pair of <b>command_id</b> and <b>shell_id</b> are not specified. <p><b>Note:</b> The command_id and shell_id you provide to fetch the output can only be used once because once the output is fetched successfully server will remove output from its cache.</p>",
            "type": "generic",
            "identifier": "run_script",
            "read_only": false,
            "parameters": {
                "script_file": {
                    "description": "The vault ID of a PowerShell script to run",
                    "contains": [
                        "vault id"
                    ],
                    "data_type": "string",
                    "primary": true,
                    "order": 1
                },
                "script_str": {
                    "description": "A PowerShell script to run",
                    "data_type": "string",
                    "order": 2
                },
                "parser": {
                    "description": "The vault ID of a custom parser to use for output",
                    "contains": [
                        "vault id"
                    ],
                    "data_type": "string",
                    "primary": true,
                    "order": 3
                },
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                },
                "async": {
                    "description": "Start the command, but don't wait for output",
                    "data_type": "boolean",
                    "default": false,
                    "order": 4
                },
                "command_id": {
                    "description": "Command ID of async command (Provide with shell_id)",
                    "data_type": "string",
                    "order": 5,
                    "primary": true,
                    "contains": [
                        "winrm command id"
                    ]
                },
                "shell_id": {
                    "description": "Shell ID of async command (Provide with command_id)",
                    "data_type": "string",
                    "order": 6,
                    "contains": [
                        "winrm shell id"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.async",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.parameter.command_id",
                    "data_type": "string",
                    "contains": [
                        "winrm command id"
                    ],
                    "example_values": [
                        "1AAA1111-1A11-11A1-1111-1A1AAA1A11A1"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.parameter.parser",
                    "data_type": "string",
                    "contains": [
                        "vault id"
                    ],
                    "example_values": [
                        "8afa5c86de9ea94ecfe5b4c0837d2543d0b20b56"
                    ]
                },
                {
                    "data_path": "action_result.parameter.script_file",
                    "data_type": "string",
                    "contains": [
                        "vault id"
                    ],
                    "example_values": [
                        "8afa5c86de9ea94ecfe5b4c0837d2543d0b20b56"
                    ]
                },
                {
                    "data_path": "action_result.parameter.script_str",
                    "data_type": "string",
                    "example_values": [
                        "Write-Host Hello"
                    ]
                },
                {
                    "data_path": "action_result.parameter.shell_id",
                    "data_type": "string",
                    "contains": [
                        "winrm shell id"
                    ],
                    "example_values": [
                        "1AAA1111-1A11-11A1-1111-1A1AAA1A11A1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.status_code",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.std_err",
                    "data_type": "string",
                    "example_values": [
                        "Error message"
                    ]
                },
                {
                    "data_path": "action_result.data.*.std_out",
                    "data_type": "string",
                    "example_values": [
                        "Successful output"
                    ]
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "column_name": "Message",
                    "column_order": 0,
                    "example_values": [
                        "Successfully ran PowerShell script"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.command_id",
                    "data_type": "string",
                    "contains": [
                        "winrm command id"
                    ],
                    "example_values": [
                        "1AAA1111-1A11-11A1-1111-1A1AAA1A11A1"
                    ]
                },
                {
                    "data_path": "action_result.summary.shell_id",
                    "data_type": "string",
                    "contains": [
                        "winrm shell id"
                    ],
                    "example_values": [
                        "1AAA1111-1A11-11A1-1111-1A1AAA1A11A1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list processes",
            "description": "List the currently running processes",
            "type": "investigate",
            "identifier": "list_processes",
            "read_only": true,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.data.*.handles",
                    "data_type": "numeric",
                    "example_values": [
                        33
                    ]
                },
                {
                    "data_path": "action_result.data.*.name",
                    "data_type": "string",
                    "contains": [
                        "process name"
                    ],
                    "example_values": [
                        "cmd"
                    ],
                    "column_name": "Process Name",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.non_paged_memory",
                    "data_type": "numeric",
                    "example_values": [
                        3
                    ],
                    "column_name": "Non Paged Memory",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.paged_memory",
                    "data_type": "numeric",
                    "example_values": [
                        1564
                    ],
                    "column_name": "Paged Memory",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.pid",
                    "data_type": "numeric",
                    "example_values": [
                        3108
                    ],
                    "contains": [
                        "pid"
                    ],
                    "column_name": "PID",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.processor_time_(s)",
                    "data_type": "numeric",
                    "example_values": [
                        0.02
                    ],
                    "column_name": "Processor Time (s)",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.virtual_memory",
                    "data_type": "numeric",
                    "example_values": [
                        14
                    ]
                },
                {
                    "data_path": "action_result.data.*.working_set",
                    "data_type": "numeric",
                    "example_values": [
                        2384
                    ],
                    "column_name": "Working Set",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.session_id",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully got process list"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.num_processes",
                    "data_type": "numeric",
                    "example_values": [
                        451
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "terminate process",
            "description": "Terminate a process",
            "type": "generic",
            "identifier": "terminate_process",
            "read_only": false,
            "parameters": {
                "pid": {
                    "description": "The PID of the process to terminate",
                    "data_type": "numeric",
                    "primary": true,
                    "contains": [
                        "pid"
                    ],
                    "order": 1
                },
                "name": {
                    "description": "Name of program to terminate, accepts wildcards",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "process name"
                    ],
                    "order": 2
                },
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.parameter.name",
                    "data_type": "string",
                    "contains": [
                        "process name"
                    ],
                    "example_values": [
                        "iexplore"
                    ]
                },
                {
                    "data_path": "action_result.parameter.pid",
                    "data_type": "numeric",
                    "contains": [
                        "pid"
                    ],
                    "example_values": [
                        451
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully terminated process"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list connections",
            "description": "List all active connections",
            "type": "investigate",
            "identifier": "list_connections",
            "read_only": true,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.data.*.foreign_address_ip",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8"
                    ],
                    "contains": [
                        "ip"
                    ],
                    "column_name": "Foreign Address",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.foreign_address_port",
                    "data_type": "string",
                    "example_values": [
                        "11100"
                    ],
                    "contains": [
                        "port"
                    ],
                    "column_name": "Foreign Address Port",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.local_address_ip",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8"
                    ],
                    "contains": [
                        "ip"
                    ],
                    "column_name": "Local Address",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.local_address_port",
                    "data_type": "string",
                    "example_values": [
                        "11100"
                    ],
                    "contains": [
                        "port"
                    ],
                    "column_name": "Local Address Port",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.pid",
                    "data_type": "numeric",
                    "example_values": [
                        451
                    ],
                    "contains": [
                        "pid"
                    ],
                    "column_name": "PID",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.protocol",
                    "data_type": "string",
                    "example_values": [
                        "TCP"
                    ],
                    "column_name": "Protocol",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.state",
                    "data_type": "string",
                    "example_values": [
                        "ESTABLISHED"
                    ]
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully listed connections"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.num_connections",
                    "data_type": "numeric",
                    "example_values": [
                        451
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list firewall rules",
            "description": "List the firewall rules",
            "verbose": "When you are using the <b>other</b> parameter, you can match for any field which is returned in the action result. It will only return a rule if it matches all of the criteria, not if it matches at least one.",
            "type": "investigate",
            "identifier": "list_firewall_rules",
            "read_only": true,
            "parameters": {
                "filter_port": {
                    "description": "Only show firewall rules acting on this port",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "port"
                    ],
                    "order": 1
                },
                "filter_ip": {
                    "description": "Only show firewall rules acting on this ip",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "ip"
                    ],
                    "order": 2
                },
                "direction": {
                    "description": "Only show firewall rules in this direction",
                    "data_type": "string",
                    "value_list": [
                        "in",
                        "out"
                    ],
                    "order": 3
                },
                "protocol": {
                    "description": "Only show firewall rules using this protocol",
                    "data_type": "string",
                    "contains": [
                        "winrm protocol"
                    ],
                    "order": 4,
                    "primary": true
                },
                "other": {
                    "description": "JSON object of key value pairs of other fields to match",
                    "data_type": "string",
                    "order": 5
                },
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.direction",
                    "data_type": "string",
                    "example_values": [
                        "in"
                    ]
                },
                {
                    "data_path": "action_result.parameter.filter_ip",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8"
                    ],
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.parameter.filter_port",
                    "data_type": "string",
                    "example_values": [
                        11100
                    ],
                    "contains": [
                        "port"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.parameter.other",
                    "data_type": "string",
                    "example_values": [
                        "{\"enabled\": \"yes\"}"
                    ]
                },
                {
                    "data_path": "action_result.parameter.protocol",
                    "data_type": "string",
                    "example_values": [
                        "tcp"
                    ],
                    "contains": [
                        "winrm protocol"
                    ]
                },
                {
                    "data_path": "action_result.data.*.action",
                    "data_type": "string",
                    "example_values": [
                        "allow"
                    ]
                },
                {
                    "data_path": "action_result.data.*.direction",
                    "data_type": "string",
                    "example_values": [
                        "in"
                    ],
                    "column_name": "Direction",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.edge_traversal",
                    "data_type": "string",
                    "example_values": [
                        "no"
                    ]
                },
                {
                    "data_path": "action_result.data.*.enabled",
                    "data_type": "string",
                    "example_values": [
                        "yes"
                    ]
                },
                {
                    "data_path": "action_result.data.*.grouping",
                    "data_type": "string",
                    "example_values": [
                        "windows remote management"
                    ]
                },
                {
                    "data_path": "action_result.data.*.local_ip",
                    "data_type": "string",
                    "example_values": [
                        "any"
                    ],
                    "contains": [
                        "ip"
                    ],
                    "column_name": "Local IP",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.local_port",
                    "data_type": "string",
                    "example_values": [
                        "5985"
                    ],
                    "contains": [
                        "port"
                    ],
                    "column_name": "Local Port",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.profiles",
                    "data_type": "string",
                    "example_values": [
                        "domain,private"
                    ]
                },
                {
                    "data_path": "action_result.data.*.protocol",
                    "data_type": "string",
                    "example_values": [
                        "tcp"
                    ],
                    "contains": [
                        "winrm protocol"
                    ]
                },
                {
                    "data_path": "action_result.data.*.remote_ip",
                    "data_type": "string",
                    "example_values": [
                        "any"
                    ],
                    "contains": [
                        "ip"
                    ],
                    "column_name": "Remote IP",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.remote_port",
                    "data_type": "string",
                    "example_values": [
                        "any"
                    ],
                    "contains": [
                        "port"
                    ],
                    "column_name": "Remote Port",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.rule_name",
                    "data_type": "string",
                    "example_values": [
                        "windows remote management (http-in)"
                    ],
                    "contains": [
                        "windows firewall rule name"
                    ],
                    "column_name": "Rule Name",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully retrieved firewall rules"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.num_rules",
                    "data_type": "numeric",
                    "example_values": [
                        451
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "delete firewall rule",
            "description": "Remove a firewall rule using netsh",
            "verbose": "This action will invoke the command <code>netsh advfirewall firewall delete rule</code>, and the rest is determined by the input. At a minimum, the rule name must be provided, but if you need to you can also specify any other arguments which the command accepts, in the same manner, that input from the <b>add firewall rule</b> gets added.",
            "type": "generic",
            "identifier": "delete_firewall_rule",
            "read_only": false,
            "parameters": {
                "name": {
                    "description": "The name of the rule to remove",
                    "data_type": "string",
                    "contains": [
                        "windows firewall rule name"
                    ],
                    "primary": true,
                    "required": true,
                    "order": 1
                },
                "dir": {
                    "description": "Blocks inbound or outbound traffic",
                    "data_type": "string",
                    "value_list": [
                        "in",
                        "out"
                    ],
                    "order": 2
                },
                "remote_ip": {
                    "description": "Firewall rule acts on this remote IP",
                    "data_type": "string",
                    "contains": [
                        "ip"
                    ],
                    "order": 3,
                    "primary": true
                },
                "local_ip": {
                    "description": "Firewall rule acts on this local IP",
                    "data_type": "string",
                    "contains": [
                        "ip"
                    ],
                    "order": 4,
                    "primary": true
                },
                "remote_port": {
                    "description": "Firewall rule acts on this remote port",
                    "data_type": "string",
                    "contains": [
                        "port"
                    ],
                    "order": 5,
                    "primary": true
                },
                "local_port": {
                    "description": "Firewall rule acts on this local port",
                    "data_type": "string",
                    "contains": [
                        "port"
                    ],
                    "order": 6,
                    "primary": true
                },
                "protocol": {
                    "description": "Firewall rule acts on this protocol",
                    "data_type": "string",
                    "contains": [
                        "winrm protocol"
                    ],
                    "order": 7,
                    "primary": true
                },
                "other": {
                    "description": "JSON object of key value pairs for other parameters to include",
                    "data_type": "string",
                    "order": 8
                },
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.dir",
                    "data_type": "string",
                    "example_values": [
                        "in",
                        "out"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.parameter.local_ip",
                    "data_type": "string",
                    "contains": [
                        "ip"
                    ],
                    "example_values": [
                        "8.8.8.8"
                    ]
                },
                {
                    "data_path": "action_result.parameter.local_port",
                    "data_type": "string",
                    "contains": [
                        "port"
                    ],
                    "example_values": [
                        "443"
                    ]
                },
                {
                    "data_path": "action_result.parameter.name",
                    "data_type": "string",
                    "contains": [
                        "windows firewall rule name"
                    ],
                    "example_values": [
                        "test rule"
                    ]
                },
                {
                    "data_path": "action_result.parameter.other",
                    "data_type": "string",
                    "example_values": [
                        "{\"profile\": \"domain\"}"
                    ]
                },
                {
                    "data_path": "action_result.parameter.protocol",
                    "data_type": "string",
                    "contains": [
                        "winrm protocol"
                    ],
                    "example_values": [
                        "any",
                        "tcp"
                    ]
                },
                {
                    "data_path": "action_result.parameter.remote_ip",
                    "data_type": "string",
                    "contains": [
                        "ip"
                    ],
                    "example_values": [
                        "8.8.8.8"
                    ]
                },
                {
                    "data_path": "action_result.parameter.remote_port",
                    "data_type": "string",
                    "contains": [
                        "port"
                    ],
                    "example_values": [
                        "443"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully deleted firewall rules"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.rules_deleted",
                    "data_type": "numeric",
                    "example_values": [
                        2
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "block ip",
            "description": "Create a firewall rule to block a specified IP",
            "type": "generic",
            "identifier": "block_ip",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                },
                "name": {
                    "description": "The name of the rule to add",
                    "data_type": "string",
                    "required": true,
                    "contains": [
                        "windows firewall rule name"
                    ],
                    "order": 1,
                    "primary": true
                },
                "remote_ip": {
                    "description": "Block this IP",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "ip"
                    ],
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.parameter.name",
                    "data_type": "string",
                    "contains": [
                        "windows firewall rule name"
                    ],
                    "example_values": [
                        "test rule"
                    ]
                },
                {
                    "data_path": "action_result.parameter.remote_ip",
                    "data_type": "string",
                    "contains": [
                        "ip"
                    ],
                    "example_values": [
                        "8.8.8.8"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully created firewall rule"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "add firewall rule",
            "description": "Add a firewall rule using netsh",
            "verbose": "This action will invoke the command <code>netsh advfirewall firewall add rule</code>, where the rest is determined by the input. Each <b>key-value</b> pair from the <b>other</b> parameter will be added in the form of <b>key</b>=<b>value</b>. The user input will  be sanitized.",
            "type": "generic",
            "identifier": "create_firewall_rule",
            "read_only": false,
            "parameters": {
                "name": {
                    "description": "The name of the rule to add",
                    "data_type": "string",
                    "required": true,
                    "contains": [
                        "windows firewall rule name"
                    ],
                    "order": 1,
                    "primary": true
                },
                "dir": {
                    "description": "Block inbound or outbound traffic",
                    "data_type": "string",
                    "required": true,
                    "value_list": [
                        "in",
                        "out"
                    ],
                    "order": 2
                },
                "action": {
                    "description": "What the firewall will do with packets",
                    "data_type": "string",
                    "required": true,
                    "value_list": [
                        "allow",
                        "block",
                        "bypass"
                    ],
                    "order": 3
                },
                "remote_ip": {
                    "description": "Firewall rule acts on this remote IP",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "ip"
                    ],
                    "order": 4
                },
                "local_ip": {
                    "description": "Firewall rule acts on this local IP",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "ip"
                    ],
                    "order": 5
                },
                "remote_port": {
                    "description": "Firewall rule acts on this remote port",
                    "data_type": "string",
                    "contains": [
                        "port"
                    ],
                    "primary": true,
                    "order": 6
                },
                "local_port": {
                    "description": "Firewall rule acts on this local port",
                    "data_type": "string",
                    "contains": [
                        "port"
                    ],
                    "order": 7,
                    "primary": true
                },
                "protocol": {
                    "description": "Firewall rule acts on this protocol",
                    "data_type": "string",
                    "contains": [
                        "winrm protocol"
                    ],
                    "order": 8,
                    "primary": true
                },
                "other": {
                    "description": "JSON object of key value pairs for other parameters to include",
                    "data_type": "string",
                    "order": 9
                },
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.action",
                    "data_type": "string",
                    "example_values": [
                        "block"
                    ]
                },
                {
                    "data_path": "action_result.parameter.dir",
                    "data_type": "string",
                    "example_values": [
                        "in",
                        "out"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.parameter.local_ip",
                    "data_type": "string",
                    "contains": [
                        "ip"
                    ],
                    "example_values": [
                        "8.8.8.8"
                    ]
                },
                {
                    "data_path": "action_result.parameter.local_port",
                    "data_type": "string",
                    "contains": [
                        "port"
                    ],
                    "example_values": [
                        "443"
                    ]
                },
                {
                    "data_path": "action_result.parameter.name",
                    "data_type": "string",
                    "contains": [
                        "windows firewall rule name"
                    ],
                    "example_values": [
                        "test rule"
                    ]
                },
                {
                    "data_path": "action_result.parameter.other",
                    "data_type": "string",
                    "example_values": [
                        "{\"profile\": \"domain\"}"
                    ]
                },
                {
                    "data_path": "action_result.parameter.protocol",
                    "data_type": "string",
                    "contains": [
                        "winrm protocol"
                    ],
                    "example_values": [
                        "any",
                        "tcp"
                    ]
                },
                {
                    "data_path": "action_result.parameter.remote_ip",
                    "data_type": "string",
                    "contains": [
                        "ip"
                    ],
                    "example_values": [
                        "8.8.8.8"
                    ]
                },
                {
                    "data_path": "action_result.parameter.remote_port",
                    "data_type": "string",
                    "contains": [
                        "port"
                    ],
                    "example_values": [
                        "443"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully created firewall rule"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "logoff user",
            "description": "Logoff a user",
            "type": "generic",
            "identifier": "logoff_user",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                },
                "session_id": {
                    "description": "Session ID",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "order": 1,
                    "contains": [
                        "windows session id"
                    ]
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ],
                    "contains": [
                        "ip",
                        "host name"
                    ]
                },
                {
                    "data_path": "action_result.parameter.session_id",
                    "data_type": "string",
                    "example_values": [
                        "2"
                    ],
                    "contains": [
                        "windows session id"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully logged off user"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list sessions",
            "description": "List all active sessions",
            "type": "investigate",
            "identifier": "list_sessions",
            "read_only": true,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                }
            },
            "output": [
               {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ],
                    "contains": [
                        "ip",
                        "host name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "0"
                    ],
                    "contains": [
                        "windows session id"
                    ],
                    "column_name": "Session ID",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.name",
                    "data_type": "string",
                    "example_values": [
                        "services"
                    ],
                    "column_name": "Name",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.this",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.username",
                    "data_type": "string",
                    "contains": [
                        "user name"
                    ],
                    "column_name": "User Name",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully listed all sessions"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.num_sessions",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "deactivate partition",
            "description": "Deactivate a partition",
            "verbose": "Deactivates the system partitions of a machine, which disallows booting from said partition. The subsequent boot of the machine results in using the next option specified in the BIOS to boot from. Often used to netboot for remote reimaging.",
            "type": "contain",
            "identifier": "deactivate_partition",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully deactivated partition"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "activate partition",
            "description": "Activate a partition",
            "type": "correct",
            "identifier": "activate_partition",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully activated partition"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "shutdown system",
            "description": "Shutdown a system",
            "type": "generic",
            "identifier": "shutdown_system",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "primary": true,
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ]
                },
                "comment": {
                    "description": "Comment to show to users",
                    "data_type": "string",
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "Test shutdown"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully initiated system shutdown"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "restart system",
            "description": "Restart a system",
            "type": "generic",
            "identifier": "restart_system",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "primary": true,
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ]
                },
                "comment": {
                    "description": "Comment to show to users",
                    "data_type": "string",
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "Test restart"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully initiated system restart"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list policies",
            "description": "List AppLocker Policies",
            "type": "investigate",
            "identifier": "list_applocker_policies",
            "read_only": true,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                },
                "location": {
                    "description": "Which policies to list",
                    "data_type": "string",
                    "required": true,
                    "order": 1,
                    "value_list": [
                        "local",
                        "domain",
                        "effective"
                    ]
                },
                "ldap": {
                    "description": "LDAP Server. Will only have an effect if 'location' is set to 'domain'",
                    "data_type": "string",
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ],
                    "contains": [
                        "ip",
                        "host name"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ldap",
                    "data_type": "string",
                    "example_values": [
                        "LDAP://8.8.8.8/CN={31b2f340-016d-11d2-945f-00c04fb984f9},CN=Policies,CN=System,DC=domain,DC=local"
                    ]
                },
                {
                    "data_path": "action_result.parameter.location",
                    "data_type": "string",
                    "example_values": [
                        "local"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Conditions.FilePublisherCondition.@BinaryName",
                    "data_type": "string",
                    "example_values": [
                        "*"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Conditions.FilePublisherCondition.@ProductName",
                    "data_type": "string",
                    "example_values": [
                        "*"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Conditions.FilePublisherCondition.@PublisherName",
                    "data_type": "string",
                    "example_values": [
                        "*"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Conditions.FilePublisherCondition.BinaryVersionRange.@HighSection",
                    "data_type": "string",
                    "example_values": [
                        "*"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Conditions.FilePublisherCondition.BinaryVersionRange.@LowSection",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8"
                    ],
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.data.*.action",
                    "data_type": "string",
                    "example_values": [
                        "Allow"
                    ],
                    "column_name": "Action",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.description",
                    "data_type": "string",
                    "example_values": [
                        "Allows members of the Everyone group to run packaged apps that are signed."
                    ],
                    "column_name": "Description",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.enforcement_mode",
                    "data_type": "string",
                    "example_values": [
                        "NotConfigured"
                    ]
                },
                {
                    "data_path": "action_result.data.*.file_path_condition",
                    "data_type": "string",
                    "example_values": [
                        "%SYSTEM32%\\NOTEPAD.EXE"
                    ],
                    "contains": [
                        "file path"
                    ],
                    "column_name": "File Path Condition",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "a9e18c21-ff8f-43cf-b9fc-db40eed693ba"
                    ],
                    "contains": [
                        "windows applocker policy id"
                    ],
                    "column_name": "ID",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.name",
                    "data_type": "string",
                    "example_values": [
                        "(Default Rule) All signed packaged apps"
                    ],
                    "column_name": "Name",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "Appx"
                    ],
                    "column_name": "Type",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.user_or_group_sid",
                    "data_type": "string",
                    "contains": [
                        "winrm user or group sid"
                    ],
                    "example_values": [
                        "S-1-1-0"
                    ],
                    "column_name": "User Or Group SID",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully listed AppLocker Policies"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "block file path",
            "description": "Create a new AppLocker policy to block a file path",
            "verbose": "By default, this policy will apply to the \"Everyone\" group. You can specify the user with either a variety of formats, which are documented <a href=\"https://technet.microsoft.com/en-us/library/ee460963.aspx\" target=\"_blank\">here</a>. By specifying LDAP, it will apply that policy to that GPO, as opposed to just the local machine. By default, Windows <b>does not</b> have the service required service running for AppLocker policies to be enforced. The <b>Application Identity</b> service must be running for AppLocker to enforce its policies.",
            "type": "generic",
            "identifier": "create_applocker_policy",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                },
                "deny_allow": {
                    "description": "Set this rule to allow or deny",
                    "data_type": "string",
                    "required": true,
                    "order": 1,
                    "value_list": [
                        "deny",
                        "allow"
                    ]
                },
                "file_path": {
                    "description": "File path to set rule to. Allows wildcards (i.e. C:\\Windows\\System32\\*.exe)",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "order": 2,
                    "contains": [
                        "file path"
                    ]
                },
                "user": {
                    "description": "User or group to apply rule to",
                    "data_type": "string",
                    "order": 3,
                    "contains": [
                        "winrm user or group sid"
                    ],
                    "primary": true
                },
                "rule_name_prefix": {
                    "description": "Prefix for new rule name",
                    "data_type": "string",
                    "order": 4
                },
                "ldap": {
                    "description": "LDAP Server",
                    "data_type": "string",
                    "order": 5
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.deny_allow",
                    "data_type": "string",
                    "example_values": [
                        "allow",
                        "deny"
                    ]
                },
                {
                    "data_path": "action_result.parameter.file_path",
                    "data_type": "string",
                    "contains": [
                        "file path"
                    ],
                    "example_values": [
                        "C:\\Windows\\System32\\notepad.exe"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ],
                    "contains": [
                        "ip",
                        "host name"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ldap",
                    "data_type": "string",
                    "example_values": [
                        "LDAP://8.8.8.8/CN={31b2f340-016d-11d2-945f-00c04fb984f9},CN=Policies,CN=System,DC=domain,DC=local"
                    ]
                },
                {
                    "data_path": "action_result.parameter.rule_name_prefix",
                    "data_type": "string",
                    "example_values": [
                        "test"
                    ]
                },
                {
                    "data_path": "action_result.parameter.user",
                    "data_type": "string",
                    "contains": [
                        "winrm user or group sid"
                    ],
                    "example_values": [
                        "Administrator"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully created AppLocker policy"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "delete policy",
            "description": "Delete an AppLocker policy",
            "type": "generic",
            "identifier": "delete_applocker_policy",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                },
                "applocker_policy_id": {
                    "description": "ID of policy to delete",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "order": 1,
                    "contains": [
                        "windows applocker policy id"
                    ]
                },
                "ldap": {
                    "description": "LDAP Server",
                    "data_type": "string",
                    "order": 2
                }
            },
            "output": [
               {
                    "data_path": "action_result.parameter.applocker_policy_id",
                    "data_type": "string",
                    "example_values": [
                        "084ab400-83b8-432d-8dc2-f180fbe301ca"
                    ],
                    "contains": [
                        "windows applocker policy id"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ],
                    "contains": [
                        "ip",
                        "host name"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ldap",
                    "data_type": "string",
                    "example_values": [
                        "LDAP://8.8.8.8/CN={31b2f340-016d-11d2-945f-00c04fb984f9},CN=Policies,CN=System,DC=domain,DC=local"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully deleted AppLocker Policy"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get file",
            "description": "Copy a file from the Windows Endpoint to the Vault",
            "type": "investigate",
            "identifier": "get_file",
            "read_only": true,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                },
                "file_path": {
                    "description": "Path to file",
                    "data_type": "string",
                    "required": true,
                    "order": 1,
                    "primary": true,
                    "contains": [
                        "file path"
                    ]
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.file_path",
                    "data_type": "string",
                    "example_values": [
                        "C:\\Users\\administrator.CORP\\logo.jpg",
                        "C:\\Users\\Administrator\\Desktop\\c.txt"
                    ],
                    "contains": [
                        "file path"
                    ],
                    "column_name": "File Path",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ],
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "column_name": "IP/Hostname",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully retrieved file and added it to the Vault"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.vault_id",
                    "data_type": "string",
                    "example_values": [
                        "8afa5c86de9ea94ecfe5b4c0837d2543d0b20b56"
                    ],
                    "contains": [
                        "sha1",
                        "vault id"
                    ],
                    "column_name": "New Vault ID",
                    "column_order": 0
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "upload file",
            "description": "Copy a file from the vault to the Windows Endpoint",
            "type": "generic",
            "identifier": "send_file",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                },
                "vault_id": {
                    "description": "Vault ID of file",
                    "data_type": "string",
                    "required": true,
                    "order": 1,
                    "primary": true,
                    "contains": [
                        "vault id"
                    ]
                },
                "destination": {
                    "description": "Path to copy file to",
                    "data_type": "string",
                    "required": true,
                    "order": 2,
                    "contains": [
                        "file path"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.destination",
                    "data_type": "string",
                    "example_values": [
                        "C:\\Users\\administrator.CORP\\Desktop\\aasdf.txt"
                    ],
                    "contains": [
                        "file path"
                    ],
                    "column_name": "Destination",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ],
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "column_name": "IP/Hostname",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.parameter.vault_id",
                    "data_type": "string",
                    "example_values": [
                        "8afa5c86de9ea94ecfe5b4c0837d2543d0b20b56"
                    ],
                    "contains": [
                        "vault id"
                    ],
                    "column_name": "Vault ID",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully sent file"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "copy file",
            "description": "Run the copy command on the Windows Endpoint",
            "verbose": "For best results, both the <b>from</b> and <b>to</b> parameters should be absolute paths to their respective locations.",
            "type": "generic",
            "identifier": "copy_file",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                },
                "from": {
                    "description": "File source (path)",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "order": 1,
                    "contains": [
                        "file path"
                    ]
                },
                "to": {
                    "description": "File destination (path)",
                    "data_type": "string",
                    "required": true,
                    "order": 2,
                    "contains": [
                        "file path"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.from",
                    "data_type": "string",
                    "example_values": [
                        "C:\\Windows\\System32\\notepad.exe"
                    ],
                    "contains": [
                        "file path"
                    ],
                    "column_name": "From",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ],
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "column_name": "IP/Hostname",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.parameter.to",
                    "data_type": "string",
                    "example_values": [
                        "C:\\Windows\\System32\\notepad_copy.exe"
                    ],
                    "contains": [
                        "file path"
                    ],
                    "column_name": "To",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully copied files"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "delete file",
            "description": "Run the delete command on the Windows Endpoint",
            "verbose": "For best results, the <b>file path</b> parameter should be an absolute path to a location.",
            "type": "generic",
            "identifier": "delete_file",
            "read_only": false,
            "parameters": {
                "ip_hostname": {
                    "description": "IP/Hostname",
                    "data_type": "string",
                    "order": 0,
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "primary": true
                },
                "file_path": {
                    "description": "Path to file",
                    "data_type": "string",
                    "required": true,
                    "order": 1,
                    "primary": true,
                    "contains": [
                        "file path"
                    ]
                },
                "force": {
                    "description": "Use the force flag for delete",
                    "data_type": "boolean",
                    "default": false,
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.file_path",
                    "data_type": "string",
                    "example_values": [
                        "C:\\Windows\\System32\\notepad.exe"
                    ],
                    "contains": [
                        "file path"
                    ],
                    "column_name": "File Path",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.parameter.force",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ],
                    "column_name": "Force",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.ip_hostname",
                    "data_type": "string",
                    "example_values": [
                        "8.8.8.8",
                        "8.8.8.8\\testphantom.local"
                    ],
                    "contains": [
                        "ip",
                        "host name"
                    ],
                    "column_name": "IP/HOSTNAME",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully deleted files"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        }
    ]
}
