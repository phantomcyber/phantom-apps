{
    "appid": "76740c11-1738-4220-afd3-bca9fc25d41f",
    "name": "ThreatQ",
    "description": "Integrates a variety of ThreatQ services into Splunk SOAR",
    "publisher": "ThreatQuotient",
    "contributors": [
      {
        "name": "Emanuel Rodrigues"
      }
    ],
    "package_name": "phantom_threatq",
    "type": "information service",
    "license": "Copyright (c) 2021 ThreatQuotient, Inc.",
    "main_module": "threatq_connector.pyc",
    "app_version": "2.0.0",
    "utctime_updated": "2020-03-13_12:00:00",
    "product_vendor": "ThreatQuotient",
    "product_name": "ThreatQ",
    "product_version_regex": "4.*",
    "min_phantom_version": "4.10.0.40961",
    "logo": "assets/tq-light-bg.png",
    "logo_dark": "assets/tq-dark-bg.png",
    "python_version": "3",
    "configuration": {
        "tq_server": {
            "description": "Server IP/Hostname",
            "data_type": "string",
            "required": true,
            "order": 0
        },
        "clientid": {
            "description": "Client ID",
            "data_type": "string",
            "required": true,
            "order": 1
        },
        "username": {
            "description": "Username",
            "data_type": "string",
            "required": true,
            "order": 2
        },
        "password": {
            "description": "Password",
            "data_type": "password",
            "required": true,
            "order": 3
        },
        "trust_ssl": {
            "description": "Trust SSL Certificate?",
            "data_type": "boolean",
            "required": true,
            "order": 4
        }
    },
    "actions": [{
        "action": "test connectivity",
        "description": "Validate the asset configuration for connectivity",
        "type": "test",
        "identifier": "test_asset_connectivity",
        "read_only": true,
        "parameters": {},
        "output": [],
        "versions": "EQ(*)"
    }, {
        "action": "query indicators",
        "description": "Query ThreatQ for Indicator Context",
        "type": "investigate",
        "identifier": "query_indicators",
        "read_only": true,
        "parameters": {
            "indicator_list": {
                "description": "A comma-separated or line-separated list of Indicator values",
                "data_type": "string",
                "contains": [
                    "domain", "ip", "email", "url", "hash", "sha256", "string",
                    "file name", "file path", "host name", "md5", "process name",
                    "sha1", "user name"
                ],
                "primary": true,
                "required": true,
                "order": 0
            },
            "exact": {
                "description": "Do we want to find an exact match or an approximate match?",
                "data_type": "boolean",
                "default": false,
                "primary": true,
                "required": false,
                "order": 1
            },
            "with_all_relationships": {
                "description": "Should we fetch all relationships with this action?",
                "data_type": "boolean",
                "default": false,
                "primary": true,
                "required": false,
                "order": 2
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_summarize",
            "title": "ThreatQ Query Results"
        },
        "output": [{
            "data_path": "action_result.summary.total",
            "data_type": "numeric"
        }, {
            "data_path": "action_result.data.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.score",
            "data_type": "numeric"
        }, {
            "data_path": "action_result.data.*.status.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.type.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.sources.*.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.attributes",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.adversaries.*.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.attack_pattern.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.campaign.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.course_of_action.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.events.*.title",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.exploit_targets.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.identity.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.incident.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.indicators.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.intrusion_set.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.malware.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.report.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.signatures.*.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.signatures.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.tool.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.ttp.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.vulnerability.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }, {
        "action": "create indicators",
        "description": "Create indicators within ThreatQ",
        "type": "investigate",
        "identifier": "create_indicators",
        "read_only": true,
        "parameters": {
            "indicator_list": {
                "description": "A comma-separated or line-separated list of indicators and indicator type (optional) name/value pairs (e.g.: IP Address: 1.1.1.1)",
                "data_type": "string",
                "contains": [
                    "domain", "ip", "email", "url", "hash", "sha256", "string",
                    "file name", "file path", "host name", "md5", "process name",
                    "sha1", "user name"
                ],
                "primary": true,
                "required": true,
                "order": 0
            },
            "indicator_status": {
                "description": "The default status for the indicators uploaded to ThreatQ",
                "data_type": "string",
                "value_list": ["Review", "Active", "Whitelisted", "Indirect", "Expired"],
                "default": "Active",
                "primary": true,
                "required": false,
                "order": 1
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_uploaded",
            "title": "ThreatQ Action Results"
        },
        "output": [{
            "data_path": "action_result.summary.total",
            "data_type": "numeric"
        }, {
            "data_path": "action_result.data.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }, {
        "action": "create adversaries",
        "description": "Create adversaries within ThreatQ",
        "type": "investigate",
        "identifier": "create_adversaries",
        "read_only": true,
        "parameters": {
            "adversary_list": {
                "description": "A comma-separated or line-separated list adversary names",
                "data_type": "string",
                "primary": true,
                "required": true
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_uploaded",
            "title": "ThreatQ Action Results"
        },
        "output": [{
            "data_path": "action_result.summary.total",
            "data_type": "numeric"
        }, {
            "data_path": "action_result.data.*.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }, {
        "action": "create custom objects",
        "description": "Create custom objects within ThreatQ",
        "type": "investigate",
        "identifier": "create_custom_objects",
        "read_only": true,
        "parameters": {
            "object_list": {
                "description": "A comma-separated or line-separated list of custom object values",
                "data_type": "string",
                "primary": true,
                "required": true,
                "order": 0
            },
            "object_type": {
                "description": "The object type of the specified list values",
                "data_type": "string",
                "value_list": [
                    "Adversary", "Attack Pattern", "Campaign", "Course of Action",
                    "Exploit Target", "Identity", "Incident", "Indicator",
                    "Intrusion Set", "Malware", "Report", "Tool", "TTP", "Vulnerability"
                ],
                "primary": true,
                "required": true,
                "order": 1
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_uploaded",
            "title": "ThreatQ Upload Results"
        },
        "output": [{
            "data_path": "action_result.summary.total",
            "data_type": "numeric"
        }, {
            "data_path": "action_result.data.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }, {
        "action": "add attribute",
        "description": "Adds an attribute to objects in ThreatQ",
        "type": "investigate",
        "identifier": "add_attribute",
        "read_only": true,
        "parameters": {
            "object_list": {
                "description": "A comma-separated or line-separated list of object values",
                "data_type": "string",
                "primary": true,
                "required": true,
                "order": 0
            },
            "object_type": {
                "description": "The object type of the specified list values",
                "data_type": "string",
                "value_list": [
                    "Adversary", "Attack Pattern", "Campaign", "Course of Action",
                    "Event", "Exploit Target", "Identity", "Incident", "Indicator",
                    "Intrusion Set", "Malware", "Report", "Tool", "TTP", "Vulnerability"
                ],
                "primary": true,
                "required": true,
                "order": 1
            },
            "attribute_name": {
                "description": "The name of the attribute in ThreatQ",
                "data_type": "string",
                "primary": true,
                "required": true,
                "order": 2
            },
            "attribute_value": {
                "description": "The value fo the attribute in ThreatQ",
                "data_type": "string",
                "primary": true,
                "required": true
                ,
                "order": 3
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_uploaded",
            "title": "ThreatQ Action Results"
        },
        "output": [{
            "data_path": "action_result.summary.total",
            "data_type": "numeric"
        }, {
            "data_path": "action_result.data.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.title",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }, {
        "action": "set indicator status",
        "description": "Set a status for a given list of indicators",
        "type": "investigate",
        "identifier": "set_indicator_status",
        "read_only": true,
        "parameters": {
            "indicator_list": {
                "description": "A comma-separated or line-separated list of indicators and indicator type (optional) name/value pairs (e.g.: IP Address: 1.1.1.1)",
                "data_type": "string",
                "contains": [
                    "domain", "ip", "email", "url", "hash", "sha256", "string",
                    "file name", "file path", "host name", "md5", "process name",
                    "sha1", "user name"
                ],
                "primary": true,
                "required": true,
                "order": 0
            },
            "indicator_status": {
                "description": "The status to give to the list of indicators",
                "data_type": "string",
                "value_list": ["Review", "Active", "Whitelisted", "Indirect", "Expired"],
                "default": "Active",
                "primary": true,
                "required": true,
                "order": 1
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_uploaded",
            "title": "ThreatQ Action Results"
        },
        "output": [{
            "data_path": "action_result.summary.total",
            "data_type": "numeric"
        }, {
            "data_path": "action_result.data.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }, {
        "action": "create task",
        "description": "Create a task within ThreatQ",
        "type": "investigate",
        "identifier": "create_task",
        "read_only": true,
        "parameters": {
            "task_prefix": {
                "description": "Prefix for the task name",
                "data_type": "string",
                "required": false,
                "default": "Investigate Event",
                "order": 0
            },
            "task_name": {
                "description": "Task name",
                "data_type": "string",
                "primary": true,
                "required": true,
                "order": 1
            },
            "assigned_to": {
                "description": "Threatq user to assign the task to",
                "data_type": "string",
                "required": false,
                "order": 2
            },
            "task_status": {
                "description": "Task status in threatq",
                "data_type": "string",
                "required": true,
                "value_list": ["To Do", "In Progress", "Review", "Done"],
                "order": 3
            },
            "task_priority": {
                "description": "Task priority in threatq",
                "data_type": "string",
                "required": true,
                "value_list": ["Low", "Medium", "High"],
                "order": 4
            },
            "task_description": {
                "description": "Task description in threatq",
                "data_type": "string",
                "required": false,
                "order": 5
            },
            "indicator_list": {
                "description": "List of indicator values (use format node)",
                "data_type": "string",
                "required": false,
                "order": 6
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_uploaded",
            "title": "ThreatQ Action Result"
        },
        "output": [{
            "data_path": "action_result.summary",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }, {
        "action": "create event",
        "description": "Create an event within ThreatQ",
        "type": "investigate",
        "identifier": "create_event",
        "read_only": true,
        "parameters": {
            "event_type": {
                "description": "The event type in ThreatQ",
                "data_type": "string",
                "value_list": [
                    "Anonymization", "Command and Control", "Compromised PKI Certificate",
                    "DoS Attack", "Exfiltration", "Host Characteristics", "Incident", "Login Compromised",
                    "Malware", "Sighting", "SQL Injection Action", "Watchlist", "Watering Hole"
                ],
                "default": "Incident",
                "required": true,
                "order": 0
            },
            "indicator_list": {
                "description": "List of comme-separated or line-separated indicator",
                "data_type": "string",
                "contains": [
                    "domain", "ip", "email", "url", "hash", "sha256", "string",
                    "file name", "file path", "host name", "md5", "process name",
                    "sha1", "user name"
                ],
                "required": false,
                "order": 1
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_uploaded",
            "title": "ThreatQ Action Result"
        },
        "output": [{
            "data_path": "action_result.summary",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.title",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }, {
        "action": "start investigation",
        "description": "Start an investigation within ThreatQ",
        "type": "investigate",
        "identifier": "start_investigation",
        "read_only": true,
        "parameters": {
            "investigation_name": {
                "description": "The investigation name",
                "data_type": "string",
                "primary": true,
                "required": true,
                "order": 0
            },
            "investigation_priority": {
                "description": "The investigation's priority",
                "data_type": "string",
                "required": true,
                "value_list": ["Normal", "Escalated"],
                "order": 1
            },
            "investigation_visbility": {
                "description": "The investigation's sharing status",
                "data_type": "string",
                "required": true,
                "value_list": ["Private", "Shared"],
                "order": 2
            },
            "investigation_description": {
                "description": "The investigation's description",
                "data_type": "string",
                "required": false,
                "order": 3
            },
            "indicator_list": {
                "description": "List of comme-separated or line-separated indicator",
                "data_type": "string",
                "required": true,
                "order": 4
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_uploaded",
            "title": "ThreatQ Action Result"
        },
        "output": [{
            "data_path": "action_result.summary",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }, {
        "action": "upload spearphish",
        "description": "Upload a spearphish attempt to ThreatQ",
        "type": "investigate",
        "identifier": "upload_spearphish",
        "read_only": true,
        "parameters": {
            "vault_id": {
                "description": "The Vault ID for the spearphish email file",
                "data_type": "string",
                "primary": true,
                "required": true,
                "order": 0
            },
            "indicator_status": {
                "description": "Default indicator status. If none selected, Review is used",
                "data_type": "string",
                "value_list": ["Review", "Active", "Whitelisted", "Indirect", "Expired"],
                "default": "Review",
                "primary": true,
                "required": false,
                "order": 1
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_uploaded",
            "title": "ThreatQ Action Result"
        },
        "output": [{
            "data_path": "action_result.summary",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.title",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }, {
        "action": "upload file",
        "description": "Upload (and parse) a file to ThreatQ",
        "type": "investigate",
        "identifier": "upload_file",
        "read_only": true,
        "parameters": {
            "vault_id": {
                "description": "The Vault ID for the file to upload",
                "data_type": "string",
                "primary": true,
                "required": true,
                "order": 0
            },
            "parse_for_indicators": {
                "description": "Whether or not to parse the file for indicators",
                "data_type": "boolean",
                "primary": true,
                "required": true,
                "order": 1
            },
            "indicator_status": {
                "description": "Default indicator status. If none selected, Review is used",
                "data_type": "string",
                "value_list": ["Review", "Active", "Whitelisted", "Indirect", "Expired"],
                "default": "Review",
                "primary": true,
                "required": false,
                "order": 2
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_uploaded",
            "title": "ThreatQ Action Result"
        },
        "output": [{
            "data_path": "action_result.summary",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }, {
        "action": "get related objects",
        "description": "Query ThreatQ for an object's relationships",
        "type": "investigate",
        "identifier": "get_related_objects",
        "read_only": true,
        "parameters": {
            "object_list": {
                "description": "A comma-separated or line-separated list of custom object values",
                "data_type": "string",
                "primary": true,
                "required": true,
                "order": 0
            },
            "object_type": {
                "description": "The object type of the specified list values",
                "data_type": "string",
                "value_list": [
                    "Adversary", "Attack Pattern", "Campaign", "Course of Action",
                    "Event", "Exploit Target", "Identity", "Incident", "Indicator",
                    "Intrusion Set", "Malware", "Report", "Tool", "TTP", "Vulnerability"
                ],
                "primary": true,
                "required": true,
                "order": 1
            },
            "related_object_type": {
                "description": "The object type of the relationships you want to find",
                "data_type": "string",
                "value_list": [
                    "Adversary", "Attack Pattern", "Campaign", "Course of Action",
                    "Event", "Exploit Target", "Identity", "Incident", "Indicator",
                    "Intrusion Set", "Malware", "Report", "Tool", "TTP", "Vulnerability"
                ],
                "primary": true,
                "required": true,
                "order": 2
            }
        },
        "render": {
            "type": "custom",
            "width": 12,
            "height": 12,
            "view": "threatq_views.render_summarize",
            "title": "ThreatQ Query Results"
        },
        "output": [{
            "data_path": "action_result.summary.total",
            "data_type": "numeric"
        }, {
            "data_path": "action_result.data.*.value",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.title",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.score",
            "data_type": "numeric"
        }, {
            "data_path": "action_result.data.*.status.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.type.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.sources.*.name",
            "data_type": "string"
        }, {
            "data_path": "action_result.data.*.attributes",
            "data_type": "string"
        }, {
            "data_path": "action_result.data",
            "data_type": "string"
        }],
        "versions": "EQ(*)"
    }]
}
