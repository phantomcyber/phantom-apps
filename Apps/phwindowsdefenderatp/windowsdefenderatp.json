{
    "appid": "e85407b7-91f0-4019-8fa4-0d29bca741d5",
    "name": "Windows Defender ATP",
    "description": "This app integrates with Windows Defender Advanced Threat Protection(ATP) to execute various containment, corrective, generic and investigative actions",
    "type": "endpoint",
    "product_vendor": "Microsoft",
    "logo": "logo_windowsdefenderatp.svg",
    "logo_dark": "logo_windowsdefenderatp_dark.svg",
    "product_name": "Windows Defender ATP",
    "product_version_regex": ".*",
    "publisher": "Splunk",
    "license": "Copyright (c) 2019-2021 Splunk Inc.",
    "app_version": "3.4.0",
    "utctime_updated": "2021-10-25T05:54:42.000000Z",
    "package_name": "phantom_windowsdefenderatp",
    "main_module": "windowsdefenderatp_connector.py",
    "python_version": "3",
    "min_phantom_version": "4.10.0.40961",
    "app_wizard_version": "1.0.0",
    "latest_tested_versions": [
        "Cloud November 2020 Release"
    ],
    "contributors": [
        {
            "name": "Adam Gold"
        }
    ],
    "rest_handler": "windowsdefenderatp_connector._handle_rest_request",
    "configuration": {
        "tenant_id": {
            "description": "Tenant ID",
            "data_type": "string",
            "required": true,
            "order": 0
        },
        "ph": {
            "data_type": "ph",
            "order": 1
        },
        "client_id": {
            "description": "Client ID",
            "data_type": "string",
            "required": true,
            "order": 2
        },
        "client_secret": {
            "description": "Client Secret",
            "data_type": "password",
            "required": true,
            "order": 3
        },
        "non_interactive": {
            "description": "Non Interactive Auth",
            "data_type": "boolean",
            "default": false,
            "order": 4
        }
    },
    "actions": [
        {
            "action": "test connectivity",
            "description": "Validate the asset configuration for connectivity using the supplied configuration",
            "type": "test",
            "identifier": "test_connectivity",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "quarantine device",
            "description": "Quarantine the device",
            "verbose": "This action can take a while to complete execution. The action retries at an interval of 5 seconds within a specified <b>timeout</b> to check if event execution is complete. If not, the action would return the latest status of the event along with the event ID.<br>The <b>get status</b> action can be used to fetch the latest status of the event with the event ID.<br>For parameter <i>type</i>, <b>&quotFull&quot</b> will completely quarantine the device while <b>&quotSelective&quot</b> will allow Skype and Outlook to be accessed.<br>The maximum timeout period for a status check is 10 minutes.",
            "type": "contain",
            "identifier": "quarantine_device",
            "read_only": false,
            "parameters": {
                "device_id": {
                    "description": "ID of the device to quarantine",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 0
                },
                "type": {
                    "description": "Type of quarantine (Default: Full)",
                    "data_type": "string",
                    "required": true,
                    "value_list": [
                        "Full",
                        "Selective"
                    ],
                    "default": "Full",
                    "order": 1
                },
                "comment": {
                    "description": "Comment for quarantine",
                    "data_type": "string",
                    "required": true,
                    "order": 2
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 30)",
                    "data_type": "numeric",
                    "default": 30,
                    "order": 3
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "selective quarantine"
                    ],
                    "column_name": "Comment",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        130
                    ]
                },
                {
                    "data_path": "action_result.parameter.type",
                    "data_type": "string",
                    "example_values": [
                        "Full"
                    ],
                    "column_name": "Quarantine Type",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T08:50:05.8076226Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "6925706d-3a7e-4596-b2d7-321fca9cd965"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T08:50:05.8076226Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "349838747f77ec74e43ab7ca70773a41f7bfb6f2"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "testuser@example.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "Selective",
                        "test"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string",
                    "example_values": [
                        "Full"
                    ]
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ],
                    "column_name": "Quarantine Status",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "Isolate"
                    ],
                    "column_name": "Event Type",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "6925706d-3a7e-4596-b2d7-321fca9cd965"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.quarantine_status",
                    "data_type": "string",
                    "example_values": [
                        "Pending"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event id: 6925706d-3a7e-4596-b2d7-321fca9cd965, Quarantine status: Pending"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "unquarantine device",
            "description": "Unquarantine the device",
            "verbose": "This action can take a while to complete execution. The action retries at an interval of 5 seconds within a specified <b>timeout</b> to check if event execution is complete. If not, the action would return the latest status of the event along with the event ID.<br>The <b>get status</b> action can be used to fetch the latest status of the event with the event ID.<br>The maximum timeout period for a status check is 10 minutes.",
            "type": "correct",
            "identifier": "unquarantine_device",
            "read_only": false,
            "parameters": {
                "device_id": {
                    "description": "ID of the device to unquarantine",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 0
                },
                "comment": {
                    "description": "Comment for unquarantine",
                    "data_type": "string",
                    "required": true,
                    "order": 1
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 30)",
                    "data_type": "numeric",
                    "default": 30,
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "unquarantine the device"
                    ],
                    "column_name": "Comment",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "349838747f77ec74e43ab7ca70773a41f7bfb6f2"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        30
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T08:52:22.7708738Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "cb15e6e0-1d53-4762-9c37-f14d412ece9e"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T08:52:22.7708738Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "349838747f77ec74e43ab7ca70773a41f7bfb6f2"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "testuser@example.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "isolation",
                        "test"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Pending"
                    ],
                    "column_name": "Unquarantine Status",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "Unisolate"
                    ],
                    "column_name": "Event Type",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "cb15e6e0-1d53-4762-9c37-f14d412ece9e"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.unquarantine_status",
                    "data_type": "string",
                    "example_values": [
                        "Pending"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event id: cb15e6e0-1d53-4762-9c37-f14d412ece9e, Unquarantine status: Pending"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get status",
            "description": "Get status of the event on a machine",
            "type": "investigate",
            "identifier": "get_status",
            "read_only": true,
            "parameters": {
                "event_id": {
                    "description": "ID of the event",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "order": 0,
                    "contains": [
                        "defender atp event id"
                    ]
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.event_id",
                    "data_type": "string",
                    "example_values": [
                        "f4ddc97a-6f4e-471c-9be5-45e0d6d64ab8"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T09:01:19.3478911Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.fileInstances",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "f4ddc97a-6f4e-471c-9be5-45e0d6d64ab8"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T09:01:27.6955788Z"
                    ],
                    "column_name": "Last Update Time",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "ae2e5bda4bb22ec9c321680079d03e5e4cdff400"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo.fileIdentifier",
                    "data_type": "string",
                    "example_values": [
                        "2dba4c14a5e97312f9edf617e1c8b0cc0d387fd8"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo.fileIdentifierType",
                    "data_type": "string",
                    "example_values": [
                        "Sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "test.user@example.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ],
                    "column_name": "Requestor",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "test"
                    ],
                    "column_name": "Comment",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.sha1",
                    "data_type": "string",
                    "example_values": [
                        "11ffeabbe42159e1365aa82463d8690c845ce7b7"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ],
                    "column_name": "Event Status",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "RunAntiVirusScan"
                    ],
                    "column_name": "Event Type",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.summary.event_status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event status: Succeeded"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "scan device",
            "description": "Scan a device for virus",
            "verbose": "This action can take a while to complete execution. The action retries at an interval of 5 seconds within a specified <b>timeout</b> to check if event execution is complete. If not, the action would return the latest status of the event along with the event ID.<br>The <b>get status</b> action can be used to fetch the latest status of the event with the event ID.<br>The maximum timeout period for a status check is 1 hour.",
            "type": "investigate",
            "identifier": "scan_device",
            "read_only": true,
            "parameters": {
                "device_id": {
                    "description": "ID of the device to scan",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 0
                },
                "scan_type": {
                    "description": "Type of scan",
                    "data_type": "string",
                    "required": true,
                    "value_list": [
                        "Quick",
                        "Full"
                    ],
                    "default": "Quick",
                    "order": 1
                },
                "comment": {
                    "description": "Comment for scan",
                    "data_type": "string",
                    "required": true,
                    "order": 2
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 30)",
                    "data_type": "numeric",
                    "default": 30,
                    "order": 3
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "column_name": "Comment",
                    "column_order": 2,
                    "example_values": [
                        "Scanning from Test"
                    ]
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0,
                    "example_values": [
                        "a3627cbcad1e9ca2dd94eed63e3f9260e2aa7e8e"
                    ]
                },
                {
                    "data_path": "action_result.parameter.scan_type",
                    "data_type": "string",
                    "column_name": "Scan Type",
                    "column_order": 1,
                    "example_values": [
                        "Quick"
                    ]
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        30
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2018-07-12T11:35:30.8573959Z"
                    ],
                    "column_name": "Creation Time",
                    "column_order": 7
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "34a0905e-316b-46eb-994d-c7d0e8ac2efb"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2018-07-12T11:35:30.8573959Z"
                    ],
                    "column_name": "Last Update Time",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "a3627cbcad1e9ca2dd94eed63e3f9260e2aa7e8e"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "testuser@example.com"
                    ],
                    "contains": [
                        "email"
                    ],
                    "column_name": "Requestor",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "From Test"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string",
                    "example_values": [
                        "Quick"
                    ]
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "InProgress"
                    ],
                    "column_name": "Scan Status",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "RunAntiVirusScan"
                    ]
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "34a0905e-316b-46eb-994d-c7d0e8ac2efb"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.scan_status",
                    "data_type": "string",
                    "example_values": [
                        "InProgress"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event id: 34a0905e-316b-46eb-994d-c7d0e8ac2efb, Scan status: InProgress"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "quarantine file",
            "description": "Quarantine a file",
            "verbose": "This action can take a while to complete execution. The action retries at an interval of 5 seconds within a specified <b>timeout</b> to check if event execution is complete. If not, the action would return the latest status of the event along with the event ID.<br>The <b>get status</b> action can be used to fetch the latest status of the event with the event ID.<br>The maximum timeout period for a status check is 10 minutes.",
            "type": "contain",
            "identifier": "quarantine_file",
            "read_only": false,
            "parameters": {
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 0
                },
                "file_hash": {
                    "description": "Identifier of the file",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1"
                    ],
                    "order": 1
                },
                "comment": {
                    "description": "Comment for quarantine",
                    "data_type": "string",
                    "required": true,
                    "order": 2
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 30)",
                    "data_type": "numeric",
                    "default": 30,
                    "order": 3
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "Test comment for file quarantine"
                    ],
                    "column_name": "Comment",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "ae2e5bda4bb22ec9c321680079d03e5e4cdff400"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.file_hash",
                    "data_type": "string",
                    "example_values": [
                        "2dba4c14a5e97312f9edf617e1c8b0cc0d387fd8"
                    ],
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "File Hash",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        125
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T06:00:00.2740597Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.fileId",
                    "data_type": "string",
                    "example_values": [
                        "e1049556edc2b28ef25b2932c722e4dc927e9d04"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.fileInstances.*.filePath",
                    "data_type": "string",
                    "contains": [
                        "file path"
                    ]
                },
                {
                    "data_path": "action_result.data.*.fileInstances.*.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "76e82ecd-54b8-400d-83be-a05d582b3546"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T06:00:00.2740597Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "ae2e5bda4bb22ec9c321680079d03e5e4cdff400"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo.fileIdentifier",
                    "data_type": "string",
                    "example_values": [
                        "2dba4c14a5e97312f9edf617e1c8b0cc0d387fd8"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo.fileIdentifierType",
                    "data_type": "string",
                    "example_values": [
                        "Sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "testuser@example.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "file quarantine"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.sha1",
                    "data_type": "string",
                    "example_values": [
                        "e1049556edc2b28ef25b2932c722e4dc927e9d04"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Pending"
                    ],
                    "column_name": "Quarantine Status",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "StopAndQuarantineFile"
                    ],
                    "column_name": "Event Type",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "76e82ecd-54b8-400d-83be-a05d582b3546"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.quarantine_status",
                    "data_type": "string",
                    "example_values": [
                        "InProgress"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event id: 76e82ecd-54b8-400d-83be-a05d582b3546, Quarantine status: Pending"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list devices",
            "description": "List of recently seen devices",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/get-machines\" target=\"_blank\">List Machines API Documentation</a>), the user can get devices last seen in the past 30 days; the maximum page size is 10,000; rate limitations for this action are 100 calls per minute and 1500 calls per hour. If the user does not specify the limit value, it will fetch 100 devices by default.",
            "type": "investigate",
            "identifier": "list_devices",
            "read_only": true,
            "parameters": {
                "input_type": {
                    "description": "Type of input (Default: All)",
                    "data_type": "string",
                    "order": 0,
                    "required": true,
                    "value_list": [
                        "All",
                        "Domain",
                        "File Hash"
                    ],
                    "default": "All"
                },
                "input": {
                    "description": "Input filter of type Domain, File hash or All",
                    "data_type": "string",
                    "order": 1,
                    "primary": true,
                    "contains": [
                        "sha1",
                        "sha256",
                        "md5",
                        "domain"
                    ]
                },
                "query": {
                    "description": "Additional OData V4 filters to apply",
                    "data_type": "string",
                    "order": 2
                },
                "limit": {
                    "description": "Maximum number of devices to return (Maximum: 10,000)",
                    "data_type": "numeric",
                    "default": 100,
                    "order": 3
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.input",
                    "data_type": "string",
                    "example_values": [
                        "filehash"
                    ],
                    "contains": [
                        "sha1",
                        "sha256",
                        "md5",
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.parameter.input_type",
                    "data_type": "string",
                    "example_values": [
                        "All"
                    ]
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric",
                    "example_values": [
                        100
                    ]
                },
                {
                    "data_path": "action_result.parameter.query",
                    "data_type": "string",
                    "example_values": [
                        "$filter=riskScore+eq+'High'"
                    ]
                },
                {
                    "data_path": "action_result.data.*.aadDeviceId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.agentVersion",
                    "data_type": "string",
                    "example_values": [
                        "10.5850.17763.404"
                    ]
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "desktop-ph2a1ro"
                    ],
                    "contains": [
                        "domain"
                    ],
                    "column_name": "Computer Name",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.exposureLevel",
                    "data_type": "string",
                    "example_values": [
                        "Medium"
                    ]
                },
                {
                    "data_path": "action_result.data.*.firstSeen",
                    "data_type": "string",
                    "example_values": [
                        "2019-04-16T00:27:12.2677222Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.groupName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.healthStatus",
                    "data_type": "string",
                    "example_values": [
                        "Active"
                    ],
                    "column_name": "Health Status",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "ae2e5bda4bb22ec9c321680079d03e5e4cdff400"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.isAadJoined",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastExternalIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "204.107.141.240"
                    ],
                    "contains": [
                        "ip"
                    ],
                    "column_name": "Last External IP Address",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.lastIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "10.1.66.140"
                    ],
                    "contains": [
                        "ip"
                    ],
                    "column_name": "Last IP Address",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.lastSeen",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T05:23:45.9643247Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineTags",
                    "data_type": "string",
                    "example_values": [
                        "Test Tag -21"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osBuild",
                    "data_type": "numeric",
                    "example_values": [
                        17763
                    ]
                },
                {
                    "data_path": "action_result.data.*.osPlatform",
                    "data_type": "string",
                    "example_values": [
                        "Windows10"
                    ],
                    "column_name": "OS",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.osProcessor",
                    "data_type": "string",
                    "example_values": [
                        "x64"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osVersion",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.rbacGroupId",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.rbacGroupName",
                    "data_type": "string",
                    "example_values": [
                        "GROUP1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.riskScore",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.systemProductName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.version",
                    "data_type": "string",
                    "example_values": [
                        "1809"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_devices",
                    "data_type": "numeric",
                    "example_values": [
                        2
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total devices: 2"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list alerts",
            "description": "List all alerts of a given type",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/get-alerts\" target=\"_blank\">List Alerts API Documentation</a>), the user can get alerts last updated in the past 30 days; the maximum page size is 10,000; rate limitations for this action are 100 calls per minute and 1500 calls per hour. If the user does not specify the limit value, it will fetch 100 alerts by default.",
            "type": "investigate",
            "identifier": "list_alerts",
            "read_only": true,
            "parameters": {
                "input_type": {
                    "description": "Type of input (Default: All)",
                    "data_type": "string",
                    "value_list": [
                        "All",
                        "Domain",
                        "File Hash",
                        "IP"
                    ],
                    "default": "All",
                    "order": 0
                },
                "input": {
                    "description": "Input filter of type Domain, File Hash and IP",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "domain",
                        "sha1",
                        "sha256",
                        "md5",
                        "ip"
                    ],
                    "order": 1
                },
                "limit": {
                    "description": "Maximum number of alerts to return (Maximum: 10,000)",
                    "data_type": "numeric",
                    "default": 100,
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.input",
                    "data_type": "string",
                    "example_values": [
                        "1b3b40fbc889fd4c645cc12c85d0805ac36ba254",
                        "fda7:e6ee:2e09:0:19f9:12ea:c80d:cf5b",
                        "google.com"
                    ],
                    "contains": [
                        "domain",
                        "sha1",
                        "sha256",
                        "md5",
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.parameter.input_type",
                    "data_type": "string",
                    "example_values": [
                        "All"
                    ]
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric",
                    "example_values": [
                        100
                    ]
                },
                {
                    "data_path": "action_result.data.*.aadTenantId",
                    "data_type": "string",
                    "example_values": [
                        "7810-b62a-4fc0-bbbb-20165d183d7f"
                    ]
                },
                {
                    "data_path": "action_result.data.*.alertCreationTime",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T01:20:51.8699882Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assignedTo",
                    "data_type": "string",
                    "example_values": [
                        "testuser@example.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.category",
                    "data_type": "string",
                    "example_values": [
                        "General"
                    ]
                },
                {
                    "data_path": "action_result.data.*.classification",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.comments.*.comment",
                    "data_type": "string",
                    "example_values": [
                        "test"
                    ]
                },
                {
                    "data_path": "action_result.data.*.comments.*.createdBy",
                    "data_type": "string",
                    "example_values": [
                        "test@example.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.comments.*.createdTime",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-01T13:21:37.869889Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.description",
                    "data_type": "string",
                    "example_values": [
                        "Malware and unwanted software are undesirable applications that perform annoying, disruptive or harmful actions on affected machines. Some of these undesirable applications can replicate and spread from one machine to another. Others can able to receive commands from remote attackers and perform activities associated with cyber attacks. This detection might indicate that Windows Defender has stopped the malware from delivering its payload. However, it is prudent to check the machine for signs of infection."
                    ]
                },
                {
                    "data_path": "action_result.data.*.detectionSource",
                    "data_type": "string",
                    "example_values": [
                        "WindowsDefenderAv"
                    ]
                },
                {
                    "data_path": "action_result.data.*.determination",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.firstEventTime",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-02T23:03:43.2077683Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "636924432519012302_1685044642"
                    ],
                    "contains": [
                        "defender atp alert id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.incidentId",
                    "data_type": "numeric",
                    "example_values": [
                        11
                    ]
                },
                {
                    "data_path": "action_result.data.*.investigationId",
                    "data_type": "numeric",
                    "example_values": [
                        10
                    ]
                },
                {
                    "data_path": "action_result.data.*.investigationState",
                    "data_type": "string",
                    "example_values": [
                        "Benign"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastEventTime",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-02T23:03:43.2077683Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastUpdateTime",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T01:29:51.9233333Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "ae2e5bda4bb22ec9c321680079d03e5e4cdff400"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.recommendedAction",
                    "data_type": "string",
                    "example_values": [
                        "Collect artifacts and determine scope Review the machine timeline for suspicious activities that may have occurred before and after the time of the alert, and record additional related artifacts (files, IPs/URLs) Look for the presence of relevant artifacts on other systems. Identify commonalities and differences between potentially compromised systems. Submit relevant files for deep analysis and review resulting in detailed behavioral information. Submit undetected files to the MMPC malware portal Initiate containment & mitigation Contact the user to verify intent and initiate local remediation actions as needed. Update AV signatures and run a full scan. The scan might reveal and remove previously-undetected malware components. Ensure that the machine has the latest security updates. In particular, ensure that you have installed the latest software, web browser, and Operating System versions. If credential theft is suspected, reset all relevant users' passwords. Block communication with relevant URLs or IPs at the organization's perimeter."
                    ]
                },
                {
                    "data_path": "action_result.data.*.resolvedTime",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T01:29:51.7614303Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.severity",
                    "data_type": "string",
                    "example_values": [
                        "Informational"
                    ]
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Resolved"
                    ]
                },
                {
                    "data_path": "action_result.data.*.threatFamilyName",
                    "data_type": "string",
                    "example_values": [
                        "Fuery"
                    ]
                },
                {
                    "data_path": "action_result.data.*.title",
                    "data_type": "string",
                    "example_values": [
                        "Windows Defender AV detected 'Fuery' malware"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_alerts",
                    "data_type": "numeric",
                    "example_values": [
                        12
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total alerts: 12"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "width": 10,
                "height": 5,
                "view": "windowsdefenderatp_view.display_alerts",
                "title": "List Alerts"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list sessions",
            "description": "List all logged in users on a machine",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/get-machine-log-on-users\" target=\"_blank\">List Sessions API Documentation</a>), the user can query on machines last seen in the past 30 days; rate limitations for this action are 100 calls per minute and 1500 calls per hour.",
            "type": "investigate",
            "identifier": "list_sessions",
            "read_only": true,
            "parameters": {
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.accountDomain",
                    "data_type": "string",
                    "example_values": [
                        "win10atp1"
                    ],
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.accountDomainName",
                    "data_type": "string",
                    "example_values": [
                        "desktop-gq5jf56"
                    ],
                    "contains": [
                        "domain"
                    ],
                    "column_name": "Account Domain Name",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.accountName",
                    "data_type": "string",
                    "example_values": [
                        "example"
                    ],
                    "column_name": "Account Name",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.accountSid",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.firstSeen",
                    "data_type": "string",
                    "example_values": [
                        "2018-07-06T00:00:00Z"
                    ],
                    "column_name": "First Seen",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "desktop-gq5jf56\\example"
                    ],
                    "column_name": "User ID",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.isDomainAdmin",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ],
                    "column_name": "Domain Admin",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.isOnlyNetworkUser",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.lastSeen",
                    "data_type": "string",
                    "example_values": [
                        "2018-07-06T00:00:00Z"
                    ],
                    "column_name": "Last Seen",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.leastPrevalentMachineId",
                    "data_type": "string",
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.logOnMachinesCount",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.logonTypes",
                    "data_type": "string",
                    "example_values": [
                        "Network, RemoteInteractive"
                    ]
                },
                {
                    "data_path": "action_result.data.*.mostPrevalentMachineId",
                    "data_type": "string",
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_sessions",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total sessions: 1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get alert",
            "description": "Retrieve specific Alert by its ID",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-alert-info-by-id\" target=\"_blank\">Get Alert Information by ID API Documentation</a>), user can get alerts last updated according to your configured retention period.; rate limitations for this action are 100 calls per minute and 1500 calls per hour.",
            "type": "investigate",
            "identifier": "get_alert",
            "read_only": true,
            "parameters": {
                "alert_id": {
                    "description": "ID of the alert",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp alert id"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.alert_id",
                    "data_type": "string",
                    "contains": [
                        "defender atp alert id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#Alerts/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.aadTenantId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.alertCreationTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.assignedTo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.category",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.classification",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.description",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.detectionSource",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.detectorId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.determination",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.aadUserId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.accountName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.detectionStatus",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.domainName",
                    "data_type": "string",
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.entityType",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.evidenceCreationTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.fileName",
                    "data_type": "string",
                    "contains": [
                        "file name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.filePath",
                    "data_type": "string",
                    "contains": [
                        "file path"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.ipAddress",
                    "data_type": "string",
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.parentProcessCreationTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.parentProcessFileName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.parentProcessFilePath",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.parentProcessId",
                    "data_type": "string",
                    "contains": [
                        "pid"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.processCommandLine",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.processCreationTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.processId",
                    "data_type": "string",
                    "contains": [
                        "pid"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.registryHive",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.registryKey",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.registryValue",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.registryValueType",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.sha1",
                    "data_type": "string",
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.sha256",
                    "data_type": "string",
                    "contains": [
                        "sha256"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.url",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.userPrincipalName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.userSid",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.firstEventTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "contains": [
                        "defender atp alert id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.incidentId",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.data.*.investigationId",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.data.*.investigationState",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.lastEventTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.lastUpdateTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.rbacGroupName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.relatedUser",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.resolvedTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.severity",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.threatFamilyName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.threatName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.title",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.action_taken",
                    "data_type": "string",
                    "example_values": [
                        "Retrieved Alert"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Action taken: Retrieved Alert"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "width": 10,
                "height": 5,
                "view": "windowsdefenderatp_view.get_alert",
                "title": "Get Alert"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "update alert",
            "description": "Update properties of existing Alert",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/update-alert\" target=\"_blank\">Get Alert Information by ID API Documentation</a>), user can update alerts that available in the API. See List Alerts for more information.; rate limitations for this action are 100 calls per minute and 1500 calls per hour.",
            "type": "investigate",
            "identifier": "update_alert",
            "read_only": false,
            "parameters": {
                "alert_id": {
                    "description": "ID of the alert",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp alert id"
                    ],
                    "order": 0
                },
                "status": {
                    "description": "Specifies the current status of the alert",
                    "data_type": "string",
                    "order": 1,
                    "value_list": [
                        "New",
                        "InProgress",
                        "Resolved"
                    ]
                },
                "assigned_to": {
                    "description": "Owner of the alert",
                    "data_type": "string",
                    "primary": true,
                    "order": 2,
                    "contains": [
                        "email"
                    ]
                },
                "classification": {
                    "description": "Specifies the specification of the alert",
                    "data_type": "string",
                    "order": 3,
                    "value_list": [
                        "Unknown",
                        "FalsePositive",
                        "TruePositive"
                    ]
                },
                "determination": {
                    "description": "Specifies the determination of the alert",
                    "data_type": "string",
                    "order": 4,
                    "value_list": [
                        "NotAvailable",
                        "Apt",
                        "Malware",
                        "SecurityPersonnel",
                        "SecurityTesting",
                        "UnwantedSoftware",
                        "Other"
                    ]
                },
                "comment": {
                    "description": "Comment to be added to the alert",
                    "data_type": "string",
                    "order": 5
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.alert_id",
                    "data_type": "string",
                    "contains": [
                        "defender atp alert id"
                    ]
                },
                {
                    "data_path": "action_result.parameter.assigned_to",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.parameter.classification",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.determination",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.aadTenantId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.alertCreationTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.assignedTo",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.category",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.classification",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.comments.*.comment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.comments.*.createdBy",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.comments.*.createdTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.description",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.detectionSource",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.detectorId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.determination",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.aadUserId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.accountName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.detectionStatus",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.domainName",
                    "data_type": "string",
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.entityType",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.evidenceCreationTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.fileName",
                    "data_type": "string",
                    "contains": [
                        "file name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.filePath",
                    "data_type": "string",
                    "contains": [
                        "file path"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.ipAddress",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.parentProcessCreationTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.parentProcessFileName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.parentProcessFilePath",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.parentProcessId",
                    "data_type": "string",
                    "contains": [
                        "pid"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.processCommandLine",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.processCreationTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.processId",
                    "data_type": "string",
                    "contains": [
                        "pid"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.registryHive",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.registryKey",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.registryValue",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.registryValueType",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.sha1",
                    "data_type": "string",
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.sha256",
                    "data_type": "string",
                    "contains": [
                        "sha256"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.url",
                    "data_type": "string",
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.evidence.*.userPrincipalName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.evidence.*.userSid",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.firstEventTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "contains": [
                        "defender atp alert id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.incidentId",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.data.*.investigationId",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.data.*.investigationState",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.lastEventTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.lastUpdateTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.rbacGroupName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.relatedUser.domainName",
                    "data_type": "string",
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedUser.userName",
                    "data_type": "string",
                    "contains": [
                        "user name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.resolvedTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.severity",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.threatFamilyName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.threatName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.title",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.action_taken",
                    "data_type": "string",
                    "example_values": [
                        "Updated Alert"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Action Taken: Updated Alert"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "width": 10,
                "height": 5,
                "view": "windowsdefenderatp_view.update_alert",
                "title": "Update Alert"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "domain prevalence",
            "description": "Return statistics for the specified domain",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-domain-statistics?view=o365-worldwide\" target=\"_blank\">Get domain statistics API Documentation</a>), rate limitations for this action are 100 calls per minute and 1500 calls per hour. The maximum value for look_back_hours is 720 hours (30 days).",
            "type": "investigate",
            "identifier": "domain_prevalence",
            "read_only": true,
            "parameters": {
                "domain": {
                    "description": "Domain to get the statistics",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "domain"
                    ],
                    "order": 0
                },
                "look_back_hours": {
                    "description": "Define the hours you search back to get the statistics (Default: 720 hours (30 days))",
                    "data_type": "numeric",
                    "default": "720",
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.domain",
                    "data_type": "string",
                    "example_values": [
                        "abc.com"
                    ],
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.parameter.look_back_hours",
                    "data_type": "numeric",
                    "example_values": [
                        720
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#microsoft.windowsDefenderATP.api.InOrgDomainStats"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.host",
                    "data_type": "string",
                    "example_values": [
                        "abc.com"
                    ],
                    "column_name": "Host Name",
                    "column_order": 0,
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.orgFirstSeen",
                    "data_type": "string",
                    "column_name": "Organization First Seen",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.orgLastSeen",
                    "data_type": "string",
                    "column_name": "Organization Last Seen",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.orgPrevalence",
                    "data_type": "string",
                    "example_values": [
                        "0"
                    ]
                },
                {
                    "data_path": "action_result.data.*.organizationPrevalence",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ],
                    "column_name": "Organization Prevalence",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.summary.organization_prevalence",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Organization prevalence: 0"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        7
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        4
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "ip prevalence",
            "description": "Return statistics for the specified IP",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-ip-statistics?view=o365-worldwide\" target=\"_blank\">Get IP statistics API Documentation</a>), rate limitations for this action are 100 calls per minute and 1500 calls per hour. The maximum value for look_back_hours is 720 hours (30 days).",
            "type": "investigate",
            "identifier": "ip_prevalence",
            "read_only": true,
            "parameters": {
                "ip": {
                    "description": "IP to get the statistics",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "ip",
                        "ipv6"
                    ],
                    "order": 0
                },
                "look_back_hours": {
                    "description": "Define the hours you search back to get the statistics (Default: 720 hours (30 days))",
                    "data_type": "numeric",
                    "default": "720",
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.ip",
                    "data_type": "string",
                    "example_values": [
                        "172.217.9.206",
                        "2001:0db8:0000:0000:0000:ff00:0042:8329"
                    ],
                    "contains": [
                        "ip",
                        "ipv6"
                    ]
                },
                {
                    "data_path": "action_result.parameter.look_back_hours",
                    "data_type": "numeric",
                    "example_values": [
                        720
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#microsoft.windowsDefenderATP.api.InOrgIPStats"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddress",
                    "data_type": "string",
                    "example_values": [
                        "172.217.9.206",
                        "2001:0db8:0000:0000:0000:ff00:0042:8329"
                    ],
                    "contains": [
                        "ip",
                        "ipv6"
                    ],
                    "column_name": "IP Address",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.orgFirstSeen",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-02T10:18:39.9233319Z"
                    ],
                    "column_name": "Organization First Seen",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.orgLastSeen",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-02T10:18:39.9233319Z"
                    ],
                    "column_name": "Organization Last Seen",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.orgPrevalence",
                    "data_type": "string",
                    "example_values": [
                        "1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.organizationPrevalence",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ],
                    "column_name": "Organization Prevalence",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.summary.organization_prevalence",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Organization prevalence: 1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "file prevalence",
            "description": "Return statistics for the specified file",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-file-statistics?view=o365-worldwide\" target=\"_blank\">Get File statistics API Documentation</a>), rate limitations for this action are 100 calls per minute and 1500 calls per hour. The maximum value for look_back_hours is 720 hours (30 days).",
            "type": "investigate",
            "identifier": "file_prevalence",
            "read_only": true,
            "parameters": {
                "file_hash": {
                    "description": "File hash to get the statistics (SHA1 or SHA256)",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1",
                        "sha256"
                    ],
                    "order": 0
                },
                "look_back_hours": {
                    "description": "Define the hours you search back to get the statistics (Default: 720 hours (30 days))",
                    "data_type": "numeric",
                    "default": "720",
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.file_hash",
                    "data_type": "string",
                    "example_values": [
                        "954e0fd64a1242d0fa860b220198118268e35018"
                    ],
                    "contains": [
                        "sha1",
                        "sha256"
                    ]
                },
                {
                    "data_path": "action_result.parameter.look_back_hours",
                    "data_type": "string",
                    "example_values": [
                        "720"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#microsoft.windowsDefenderATP.api.InOrgFileStats"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.globalFirstObserved",
                    "data_type": "string",
                    "example_values": [
                        "2021-07-11T08:50:15.2316886Z"
                    ],
                    "column_name": "Global First Observed",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.globalLastObserved",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-20T10:15:33.4741238Z"
                    ],
                    "column_name": "Global Last Observed",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.globalPrevalence",
                    "data_type": "string",
                    "example_values": [
                        "64356"
                    ]
                },
                {
                    "data_path": "action_result.data.*.globallyPrevalence",
                    "data_type": "numeric",
                    "example_values": [
                        64356
                    ],
                    "column_name": "Global Prevalence",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.orgFirstSeen",
                    "data_type": "string",
                    "column_name": "Organization First Seen",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.orgLastSeen",
                    "data_type": "string",
                    "column_name": "Organization Last Seen",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.orgPrevalence",
                    "data_type": "string",
                    "example_values": [
                        "0"
                    ]
                },
                {
                    "data_path": "action_result.data.*.organizationPrevalence",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ],
                    "column_name": "Organization Prevalence",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.sha1",
                    "data_type": "string",
                    "example_values": [
                        "954e0fd64a1242d0fa860b220198118268e35018"
                    ],
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "SHA1",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.topFileNames",
                    "data_type": "string",
                    "example_values": [
                        "mssense.exe"
                    ],
                    "contains": [
                        "file name"
                    ]
                },
                {
                    "data_path": "action_result.summary.organization_prevalence",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Organization prevalence: 0"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get file info",
            "description": "Retrieve a File information by identifier SHA1, or SHA256",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-file-information?view=o365-worldwide\" target=\"_blank\">Get File Information API Documentation</a>), rate limitations for this action are 100 calls per minute and 1500 calls per hour. The valid file identifiers are SHA1, SHA256.",
            "type": "investigate",
            "identifier": "get_file_info",
            "read_only": true,
            "parameters": {
                "file_hash": {
                    "description": "Identifier of the file",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1",
                        "sha256"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ],
                    "column_name": "Status",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.file_hash",
                    "data_type": "string",
                    "example_values": [
                        "954e0fd64a1242d0fa860b220198118268e35018",
                        "1a563e59bfcdc9e7b4d8ac81c6b6579e2d215952f6dd98e0ab1ab026ac616896"
                    ],
                    "contains": [
                        "sha1",
                        "sha256"
                    ],
                    "column_name": "File Hash",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#Files/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.determinationType",
                    "data_type": "string",
                    "example_values": [
                        "Unknown"
                    ]
                },
                {
                    "data_path": "action_result.data.*.determinationValue",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.fileProductName",
                    "data_type": "string",
                    "example_values": [
                        "Windows Operating System"
                    ]
                },
                {
                    "data_path": "action_result.data.*.filePublisher",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.fileType",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.globalFirstObserved",
                    "data_type": "string",
                    "example_values": [
                        "2021-07-11T08:50:15.2316886Z"
                    ],
                    "column_name": "Global First Observed",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.globalLastObserved",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-19T10:33:39.6552836Z"
                    ],
                    "column_name": "Global Last Observed",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.globalPrevalence",
                    "data_type": "numeric",
                    "example_values": [
                        64134
                    ],
                    "column_name": "Global Prevalence",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.isPeFile",
                    "data_type": "boolean",
                    "example_values": [
                        true
                    ]
                },
                {
                    "data_path": "action_result.data.*.isValidCertificate",
                    "data_type": "boolean",
                    "example_values": [
                        true
                    ]
                },
                {
                    "data_path": "action_result.data.*.issuer",
                    "data_type": "string",
                    "example_values": [
                        "Test Windows Production PCA 2011"
                    ],
                    "column_name": "Issuer",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.md5",
                    "data_type": "string",
                    "example_values": [
                        "44adb27786eb24e5bbfd06b69e84d252"
                    ],
                    "contains": [
                        "md5"
                    ]
                },
                {
                    "data_path": "action_result.data.*.sha1",
                    "data_type": "string",
                    "example_values": [
                        "954e0fd64a1242d0fa860b220198118268e35018"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.sha256",
                    "data_type": "string",
                    "example_values": [
                        "1a563e59bfcdc9e7b4d8ac81c6b6579e2d215952f6dd98e0ab1ab026ac616896"
                    ],
                    "contains": [
                        "sha256"
                    ]
                },
                {
                    "data_path": "action_result.data.*.signer",
                    "data_type": "string",
                    "example_values": [
                        "Windows Publisher"
                    ]
                },
                {
                    "data_path": "action_result.data.*.signerHash",
                    "data_type": "string",
                    "example_values": [
                        "4f95a05d113f1f31b481e92f8f0d2b9889545004"
                    ]
                },
                {
                    "data_path": "action_result.data.*.size",
                    "data_type": "numeric",
                    "example_values": [
                        5395384
                    ],
                    "column_name": "Size",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.summary.global_prevalence",
                    "data_type": "numeric",
                    "example_values": [
                        64355
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully retrieved file information"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get file devices",
            "description": "Retrieve a collection of devices related to a given file hash (SHA1)",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-file-related-machines?view=o365-worldwide\" target=\"_blank\">Get File Related Machines API Documentation</a>), rate limitations for this action are 100 calls per minute and 1500 calls per hour. The valid file identifier is SHA1.<br>The action retrieves data of the last 30 days.",
            "type": "investigate",
            "identifier": "get_file_related_devices",
            "read_only": true,
            "parameters": {
                "file_hash": {
                    "description": "Identifier of the file",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.file_hash",
                    "data_type": "string",
                    "example_values": [
                        "954e0fd64a1242d0fa860b220198118268e35018"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.aadDeviceId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.agentVersion",
                    "data_type": "string",
                    "example_values": [
                        "10.7740.19041.1110"
                    ]
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "testmachine4"
                    ]
                },
                {
                    "data_path": "action_result.data.*.defenderAvStatus",
                    "data_type": "string",
                    "example_values": [
                        "Updated"
                    ],
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.deviceValue",
                    "data_type": "string",
                    "example_values": [
                        "Normal"
                    ]
                },
                {
                    "data_path": "action_result.data.*.exposureLevel",
                    "data_type": "string",
                    "example_values": [
                        "Medium"
                    ]
                },
                {
                    "data_path": "action_result.data.*.firstSeen",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-02T06:12:16.3736341Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.healthStatus",
                    "data_type": "string",
                    "example_values": [
                        "Inactive"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "803c416946e8738b7711903a28362adeae6e1aea"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.ipAddress",
                    "data_type": "string",
                    "example_values": [
                        "10.1.1.4"
                    ],
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.macAddress",
                    "data_type": "string",
                    "example_values": [
                        "000D3A7B423C"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.operationalStatus",
                    "data_type": "string",
                    "example_values": [
                        "Up"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.type",
                    "data_type": "string",
                    "example_values": [
                        "Ethernet"
                    ]
                },
                {
                    "data_path": "action_result.data.*.isAadJoined",
                    "data_type": "boolean",
                    "example_values": [
                        false,
                        true
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastExternalIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "137.116.83.101"
                    ],
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "10.1.1.4"
                    ],
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastSeen",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-04T13:40:25.2473895Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.onboardingStatus",
                    "data_type": "string",
                    "example_values": [
                        "Onboarded"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osArchitecture",
                    "data_type": "string",
                    "example_values": [
                        "64-bit"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osBuild",
                    "data_type": "numeric",
                    "example_values": [
                        19042
                    ]
                },
                {
                    "data_path": "action_result.data.*.osPlatform",
                    "data_type": "string",
                    "example_values": [
                        "Windows10"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osProcessor",
                    "data_type": "string",
                    "example_values": [
                        "x64"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osVersion",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.rbacGroupId",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.rbacGroupName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.riskScore",
                    "data_type": "string",
                    "example_values": [
                        "Medium"
                    ]
                },
                {
                    "data_path": "action_result.data.*.version",
                    "data_type": "string",
                    "example_values": [
                        "20H2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.cloudProvider",
                    "data_type": "string",
                    "example_values": [
                        "Azure"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.resourceId",
                    "data_type": "string",
                    "example_values": [
                        "/subscriptions/1b922e46-8595-4749-997a-1205e714cd91/resourceGroups/evaluation_3e5d447ba5d6470b9636a8709cd5b26a_4/providers/Microsoft.Compute/virtualMachines/TestMachine4"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.subscriptionId",
                    "data_type": "string",
                    "example_values": [
                        "1b922e46-8595-4749-997a-1205e714cd91"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.vmId",
                    "data_type": "string",
                    "example_values": [
                        "238443dc-56ce-487f-aeb6-261a2a00a38c"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_devices",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total devices: 1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "width": 10,
                "height": 5,
                "view": "windowsdefenderatp_view.display_devices",
                "title": "Get File Devices"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get user devices",
            "description": "Retrieve a collection of devices related to a given user ID",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-user-related-machines?view=o365-worldwide\" target=\"_blank\">Get User Related Machines API Documentation</a>), rate limitations for this action are 100 calls per minute and 1500 calls per hour. The ID is not the full UPN, but only the user name. (for example, to retrieve machines for user1@contoso.com use user1 for user_id parameter).<br>The action retrieves data of the last 30 days.",
            "type": "investigate",
            "identifier": "get_user_related_devices",
            "read_only": true,
            "parameters": {
                "user_id": {
                    "description": "ID of the user",
                    "data_type": "string",
                    "required": true,
                    "order": 0,
                    "contains": [
                        "user name"
                    ],
                    "primary": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.user_id",
                    "data_type": "string",
                    "example_values": [
                        "Administrator1"
                    ],
                    "contains": [
                        "user name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.aadDeviceId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.agentVersion",
                    "data_type": "string",
                    "example_values": [
                        "10.7740.19041.1110"
                    ]
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "testmachine4"
                    ],
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.defenderAvStatus",
                    "data_type": "string",
                    "example_values": [
                        "Updated"
                    ]
                },
                {
                    "data_path": "action_result.data.*.deviceValue",
                    "data_type": "string",
                    "example_values": [
                        "Normal"
                    ]
                },
                {
                    "data_path": "action_result.data.*.exposureLevel",
                    "data_type": "string",
                    "example_values": [
                        "Medium"
                    ]
                },
                {
                    "data_path": "action_result.data.*.firstSeen",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-02T06:12:16.3736341Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.healthStatus",
                    "data_type": "string",
                    "example_values": [
                        "Inactive"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "803c416946e8738b7711903a28362adeae6e1aea"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.ipAddress",
                    "data_type": "string",
                    "example_values": [
                        "10.1.1.4"
                    ],
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.macAddress",
                    "data_type": "string",
                    "example_values": [
                        "000D3A7B423C"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.operationalStatus",
                    "data_type": "string",
                    "example_values": [
                        "Up"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.type",
                    "data_type": "string",
                    "example_values": [
                        "Ethernet"
                    ]
                },
                {
                    "data_path": "action_result.data.*.isAadJoined",
                    "data_type": "boolean",
                    "example_values": [
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastExternalIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "137.116.83.101"
                    ],
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "10.1.1.4"
                    ],
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastSeen",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-04T13:40:25.2473895Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.onboardingStatus",
                    "data_type": "string",
                    "example_values": [
                        "Onboarded"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osArchitecture",
                    "data_type": "string",
                    "example_values": [
                        "64-bit"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osBuild",
                    "data_type": "numeric",
                    "example_values": [
                        19042
                    ]
                },
                {
                    "data_path": "action_result.data.*.osPlatform",
                    "data_type": "string",
                    "example_values": [
                        "Windows10"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osProcessor",
                    "data_type": "string",
                    "example_values": [
                        "x64"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osVersion",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.rbacGroupId",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.rbacGroupName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.riskScore",
                    "data_type": "string",
                    "example_values": [
                        "Medium"
                    ]
                },
                {
                    "data_path": "action_result.data.*.version",
                    "data_type": "string",
                    "example_values": [
                        "20H2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.cloudProvider",
                    "data_type": "string",
                    "example_values": [
                        "Azure"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.resourceId",
                    "data_type": "string",
                    "example_values": [
                        "/subscriptions/1b922e46-8595-4749-997a-1205e714cd91/resourceGroups/evaluation_3e5d447ba5d6470b9636a8709cd5b26a_4/providers/Microsoft.Compute/virtualMachines/TestMachine4"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.subscriptionId",
                    "data_type": "string",
                    "example_values": [
                        "1b922e46-8595-4749-997a-1205e714cd91"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.vmId",
                    "data_type": "string",
                    "example_values": [
                        "238443dc-56ce-487f-aeb6-261a2a00a38c"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_devices",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total devices: 1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "width": 10,
                "height": 5,
                "view": "windowsdefenderatp_view.display_devices",
                "title": "Get User Devices"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get installed software",
            "description": "Retrieve a collection of installed software related to a given device ID",
            "type": "investigate",
            "identifier": "get_installed_software",
            "read_only": true,
            "parameters": {
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.activeAlert",
                    "data_type": "boolean",
                    "example_values": [
                        false
                    ],
                    "column_name": "Active Alert",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.exposedMachines",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ],
                    "column_name": "Exposed Machines",
                    "column_order": 7
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "test-_-.net_framework"
                    ],
                    "column_name": "Software ID",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.impactScore",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ],
                    "column_name": "Impact Score",
                    "column_order": 9
                },
                {
                    "data_path": "action_result.data.*.installedMachines",
                    "data_type": "numeric",
                    "example_values": [
                        5
                    ],
                    "column_name": "Installed Machines",
                    "column_order": 8
                },
                {
                    "data_path": "action_result.data.*.name",
                    "data_type": "string",
                    "example_values": [
                        ".net_framework"
                    ],
                    "column_name": "Software Name",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.publicExploit",
                    "data_type": "boolean",
                    "example_values": [
                        false
                    ],
                    "column_name": "Public Exploit",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.vendor",
                    "data_type": "string",
                    "example_values": [
                        "Test Vendor"
                    ],
                    "column_name": "Vendor",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.weaknesses",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ],
                    "column_name": "Weaknesses",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.summary.total_software",
                    "data_type": "numeric",
                    "example_values": [
                        9
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total software: 9"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "restrict app execution",
            "description": "Restrict execution of all applications on the device except a predefined set",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/restrict-code-execution?view=o365-worldwide\" target=\"_blank\">Restrict app execution API Documentation</a>), rate limitations for this API are 100 calls per minute and 1500 calls per hour.<br>This action can take a while to complete execution. The action retries at an interval of 5 seconds within a specified <b>timeout</b> to check if event execution is complete. If not, the action would return the latest status of the event along with the event ID.<br>The <b>get status</b> action can be used to fetch the latest status of the event with the event ID.<br>The maximum timeout period for a status check is 1 minute.",
            "type": "contain",
            "identifier": "restrict_app_execution",
            "read_only": false,
            "undo": "remove app restriction",
            "parameters": {
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 0
                },
                "comment": {
                    "description": "Comment",
                    "data_type": "string",
                    "required": true,
                    "order": 1
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 30)",
                    "data_type": "numeric",
                    "default": 30,
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "Restrict code execution due to alert 1234"
                    ],
                    "column_name": "Comment",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        30
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T08:50:05.8076226Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.externalId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "6925706d-3a7e-4596-b2d7-321fca9cd965"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T08:50:05.8076226Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "349838747f77ec74e43ab7ca70773a41f7bfb6f2"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.requestSource",
                    "data_type": "string",
                    "example_values": [
                        "PublicApi"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "65265db5-a7ca-4199-a425-f37ad1dd6d31"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "Restrict code execution due to alert 1234"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ],
                    "column_name": "Status",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.title",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.troubleshootInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "RestrictCodeExecution"
                    ],
                    "column_name": "Event Type",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "6925706d-3a7e-4596-b2d7-321fca9cd965"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.restriction_status",
                    "data_type": "string",
                    "example_values": [
                        "Pending"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event id: cd2ab57e-5b52-43b0-99d8-c370fc620a54, Restriction status: Succeeded"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list indicators",
            "description": "Retrieve a collection of all active Indicators",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-ti-indicators-collection?view=o365-worldwide\" target=\"_blank\">List Indicators API Documentation</a>), rate limitations for this action are 100 calls per minute and 1500 calls per hour. If the user does not specify the limit value, it will fetch 100 indicators by default. The maximum value for the limit parameter is 10000.",
            "type": "investigate",
            "identifier": "list_indicators",
            "read_only": true,
            "parameters": {
                "filter": {
                    "description": "Additional OData V4 filters to apply",
                    "data_type": "string",
                    "order": 0
                },
                "limit": {
                    "description": "Maximum number of indicators to return (Maximum: 10,000)",
                    "data_type": "numeric",
                    "default": 100,
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.filter",
                    "data_type": "string",
                    "example_values": [
                        "severity+eq+'Informational'"
                    ]
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric",
                    "example_values": [
                        3
                    ]
                },
                {
                    "data_path": "action_result.data.*.action",
                    "data_type": "string",
                    "example_values": [
                        "Alert",
                        "Warn",
                        "Block",
                        "Audit",
                        "BlockAndRemediate",
                        "AlertAndBlock",
                        "Allowed"
                    ],
                    "column_name": "Action",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.additionalInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.application",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.bypassDurationHours",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.category",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.certificateInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.createdBy",
                    "data_type": "string",
                    "example_values": [
                        "test@testdomain.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.createdByDisplayName",
                    "data_type": "string",
                    "example_values": [
                        "testuser@domain.onmicrosoft.com"
                    ],
                    "column_name": "Created By",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.createdBySource",
                    "data_type": "string",
                    "example_values": [
                        "Portal"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationTimeDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-25T12:30:51.7279453Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.description",
                    "data_type": "string",
                    "example_values": [
                        "Test-ATP"
                    ]
                },
                {
                    "data_path": "action_result.data.*.educateUrl",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.expirationTime",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-26T00:00:00Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.externalId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.generateAlert",
                    "data_type": "boolean",
                    "example_values": [
                        false,
                        true
                    ]
                },
                {
                    "data_path": "action_result.data.*.historicalDetection",
                    "data_type": "boolean",
                    "example_values": [
                        false,
                        true
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "13"
                    ],
                    "column_name": "Indicator ID",
                    "column_order": 0,
                    "contains": [
                        "defender atp indicator id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.indicatorType",
                    "data_type": "string",
                    "example_values": [
                        "FileSha1",
                        "FileMd5",
                        "CertificateThumbprint",
                        "FileSha256",
                        "IpAddress",
                        "DomainName",
                        "Url"
                    ],
                    "column_name": "Indicator Type",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.indicatorValue",
                    "data_type": "string",
                    "example_values": [
                        "63b79504702c9c977e7165ad75d2e6989b2c5962"
                    ],
                    "contains": [
                        "defender atp indicator value",
                        "sha1",
                        "sha256",
                        "md5",
                        "domain",
                        "ip",
                        "ipv6",
                        "url"
                    ],
                    "column_name": "Indicator Value",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.lastUpdateTime",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-25T12:30:51.7457726Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastUpdatedBy",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.lookBackPeriod",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.notificationBody",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.notificationId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.recommendedActions",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.severity",
                    "data_type": "string",
                    "example_values": [
                        "Informational"
                    ],
                    "column_name": "Severity",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.title",
                    "data_type": "string",
                    "example_values": [
                        "Test"
                    ],
                    "column_name": "Title",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.version",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.total_indicators",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total indicators: 1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "submit indicator",
            "description": "Submit or Update new Indicator entity",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/post-ti-indicator?view=o365-worldwide\" target=\"_blank\">Submit or Update Indicator API Documentation</a>), rate limitations for this action are 100 calls per minute and 1500 calls per hour. There is a limit of 15,000 active indicators per tenant.<br><b>Notes:</b><ul><li>For the possible values of given action parameters, refer to the documentation link provided above.<li>CIDR notation for IPs is not supported.</li></ul>",
            "type": "generic",
            "identifier": "submit_indicator",
            "read_only": false,
            "parameters": {
                "title": {
                    "description": "Indicator alert title",
                    "data_type": "string",
                    "required": true,
                    "order": 0
                },
                "description": {
                    "description": "Description of the indicator",
                    "data_type": "string",
                    "required": true,
                    "order": 1
                },
                "indicator_type": {
                    "description": "Type of the indicator",
                    "data_type": "string",
                    "required": true,
                    "order": 2
                },
                "indicator_value": {
                    "description": "Identity of the Indicator entity",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp indicator value",
                        "sha1",
                        "sha256",
                        "md5",
                        "ip",
                        "ipv6",
                        "url",
                        "domain"
                    ],
                    "order": 3
                },
                "action": {
                    "description": "The action that will be taken if the indicator will be discovered in the organization",
                    "data_type": "string",
                    "required": true,
                    "order": 4
                },
                "application": {
                    "description": "The application associated with the indicator",
                    "data_type": "string",
                    "order": 5
                },
                "expiration_time": {
                    "description": "The expiration time of the indicator (Use this format: %Y-%m-%dT%H:%M:%SZ in UTC timezone)",
                    "data_type": "string",
                    "order": 6
                },
                "severity": {
                    "description": "The severity of the indicator",
                    "data_type": "string",
                    "value_list": [
                        "Informational",
                        "Low",
                        "Medium",
                        "High"
                    ],
                    "order": 7
                },
                "recommended_actions": {
                    "description": "TI indicator alert recommended actions",
                    "data_type": "string",
                    "order": 8
                },
                "rbac_group_names": {
                    "description": "RBAC group names the indicator would be applied to (JSON formatted list)",
                    "data_type": "string",
                    "order": 9
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.action",
                    "data_type": "string",
                    "example_values": [
                        "Alert",
                        "Warn",
                        "Block",
                        "Audit",
                        "BlockAndRemediate",
                        "AlertAndBlock",
                        "Allowed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.application",
                    "data_type": "string",
                    "example_values": [
                        "Test App"
                    ]
                },
                {
                    "data_path": "action_result.parameter.description",
                    "data_type": "string",
                    "example_values": [
                        "Test 1"
                    ]
                },
                {
                    "data_path": "action_result.parameter.expiration_time",
                    "data_type": "string",
                    "example_values": [
                        "2021-09-07T00:00:00Z"
                    ]
                },
                {
                    "data_path": "action_result.parameter.indicator_type",
                    "data_type": "string",
                    "example_values": [
                        "FileSha1",
                        "FileMd5",
                        "CertificateThumbprint",
                        "FileSha256",
                        "IpAddress",
                        "DomainName",
                        "Url"
                    ]
                },
                {
                    "data_path": "action_result.parameter.indicator_value",
                    "data_type": "string",
                    "example_values": [
                        "domain.com"
                    ],
                    "contains": [
                        "defender atp indicator value",
                        "sha1",
                        "sha256",
                        "md5",
                        "ip",
                        "ipv6",
                        "url",
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.parameter.rbac_group_names",
                    "data_type": "string",
                    "example_values": [
                        "[\"Group1\", \"Group2\"]"
                    ]
                },
                {
                    "data_path": "action_result.parameter.recommended_actions",
                    "data_type": "string",
                    "example_values": [
                        "Test Actions"
                    ]
                },
                {
                    "data_path": "action_result.parameter.severity",
                    "data_type": "string",
                    "example_values": [
                        "Low"
                    ]
                },
                {
                    "data_path": "action_result.parameter.title",
                    "data_type": "string",
                    "example_values": [
                        "Test 1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#Indicators/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.action",
                    "data_type": "string",
                    "example_values": [
                        "Alert",
                        "Warn",
                        "Block",
                        "Audit",
                        "BlockAndRemediate",
                        "AlertAndBlock",
                        "Allowed"
                    ],
                    "column_name": "Action",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.additionalInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.application",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.bypassDurationHours",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.category",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.certificateInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.createdBy",
                    "data_type": "string",
                    "example_values": [
                        "65265db5-a7ca-4199-a425-f37ad1dd6d31"
                    ]
                },
                {
                    "data_path": "action_result.data.*.createdByDisplayName",
                    "data_type": "string",
                    "example_values": [
                        "WindowsDefenderATPSiemConnector"
                    ],
                    "column_name": "Created By",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.createdBySource",
                    "data_type": "string",
                    "example_values": [
                        "PublicApi"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationTimeDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-27T12:50:54.882519Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.description",
                    "data_type": "string",
                    "example_values": [
                        "Test 1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.educateUrl",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.expirationTime",
                    "data_type": "string",
                    "example_values": [
                        "2021-09-07T00:00:00Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.externalId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.generateAlert",
                    "data_type": "boolean",
                    "example_values": [
                        false,
                        true
                    ]
                },
                {
                    "data_path": "action_result.data.*.historicalDetection",
                    "data_type": "boolean",
                    "example_values": [
                        false,
                        true
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "17"
                    ],
                    "contains": [
                        "defender atp indicator id"
                    ],
                    "column_name": "Indicator ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.indicatorType",
                    "data_type": "string",
                    "example_values": [
                        "FileSha1",
                        "FileMd5",
                        "CertificateThumbprint",
                        "FileSha256",
                        "IpAddress",
                        "DomainName",
                        "Url"
                    ],
                    "column_name": "Indicator Type",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.indicatorValue",
                    "data_type": "string",
                    "example_values": [
                        "test.com"
                    ],
                    "contains": [
                        "defender atp indicator value",
                        "ip",
                        "ipv6",
                        "sha1",
                        "sha256",
                        "md5",
                        "domain",
                        "url"
                    ],
                    "column_name": "Indicator Value",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.lastUpdateTime",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-27T12:55:42.0621261Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastUpdatedBy",
                    "data_type": "string",
                    "example_values": [
                        "65265db5-a7ca-4199-a425-f37ad1dd6d31"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lookBackPeriod",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.notificationBody",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.notificationId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.recommendedActions",
                    "data_type": "string",
                    "example_values": [
                        "Test Actions"
                    ]
                },
                {
                    "data_path": "action_result.data.*.severity",
                    "data_type": "string",
                    "example_values": [
                        "Low"
                    ],
                    "column_name": "Severity",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.title",
                    "data_type": "string",
                    "example_values": [
                        "Test 1"
                    ],
                    "column_name": "Title",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.version",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.indicator_id",
                    "data_type": "string",
                    "example_values": [
                        "17"
                    ],
                    "contains": [
                        "defender atp indicator id"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Indicator id: 17"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "delete indicator",
            "description": "Delete an Indicator entity by ID",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/delete-ti-indicator-by-id?view=o365-worldwide\" target=\"_blank\">Delete Indicator API Documentation</a>), rate limitations for this action are 100 calls per minute and 1500 calls per hour.",
            "type": "generic",
            "identifier": "delete_indicator",
            "read_only": false,
            "parameters": {
                "indicator_id": {
                    "description": "Indicator ID to delete",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp indicator id"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ],
                    "column_name": "Status",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.indicator_id",
                    "data_type": "string",
                    "example_values": [
                        "16"
                    ],
                    "contains": [
                        "defender atp indicator id"
                    ],
                    "column_name": "Indicator ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully deleted indicator entity"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "run query",
            "description": "An advanced search query",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/run-advanced-query-api?view=o365-worldwide\" target=\"_blank\">Advanced Hunting API Documentation</a>), <li>rate limitations for this action are 45 calls per minute and 1500 calls per hour.</li><li>You can only run a query on data from the last 30 days.</li><li>The execution time is 10 minutes for every hour and 3 hours of running time a day. The maximal execution time of a single request is 10 minutes.</li><li>The maximum query result size of a single request cannot exceed 124 MB. If exceeded, HTTP 400 Bad Request with the message \"Query execution has exceeded the allowed result size. Optimize your query by limiting the amount of results and try again\" will appear.</li><li>The 429 response indicates that you have reached your quota limit, either in terms of requests or CPU usage. To figure out what limit has been reached, read the response body.</li>",
            "type": "investigate",
            "identifier": "run_query",
            "read_only": true,
            "parameters": {
                "query": {
                    "description": "Query to fetch results",
                    "data_type": "string",
                    "required": true,
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.query",
                    "data_type": "string",
                    "example_values": [
                        "DeviceProcessEvents   |where InitiatingProcessFileName =~ 'powershell.exe' |where ProcessCommandLine contains 'appdata' |project Timestamp, FileName, InitiatingProcessFileName, DeviceId |limit 2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.AntivirusEnabled",
                    "data_type": "string",
                    "example_values": [
                        "BAD"
                    ]
                },
                {
                    "data_path": "action_result.data.*.AntivirusReporting",
                    "data_type": "string",
                    "example_values": [
                        "N/A"
                    ]
                },
                {
                    "data_path": "action_result.data.*.AntivirusSignatureVersion",
                    "data_type": "string",
                    "example_values": [
                        "N/A"
                    ]
                },
                {
                    "data_path": "action_result.data.*.BehaviorMonitoring",
                    "data_type": "string",
                    "example_values": [
                        "GOOD"
                    ]
                },
                {
                    "data_path": "action_result.data.*.CloudProtection",
                    "data_type": "string",
                    "example_values": [
                        "BAD"
                    ]
                },
                {
                    "data_path": "action_result.data.*.DeviceId",
                    "data_type": "string",
                    "example_values": [
                        "803c416946e8738b7711903a28362adeae6e1aea"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.DeviceName",
                    "data_type": "string",
                    "example_values": [
                        "testserver9"
                    ]
                },
                {
                    "data_path": "action_result.data.*.DomainName",
                    "data_type": "string",
                    "example_values": [
                        "TestServer9"
                    ],
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.DurationAtLeast",
                    "data_type": "string",
                    "example_values": [
                        "00.12:00:36"
                    ]
                },
                {
                    "data_path": "action_result.data.*.FileName",
                    "data_type": "string",
                    "example_values": [
                        "csc.exe"
                    ],
                    "contains": [
                        "file name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ImpairedCommunications",
                    "data_type": "string",
                    "example_values": [
                        "BAD"
                    ]
                },
                {
                    "data_path": "action_result.data.*.InitiatingProcessFileName",
                    "data_type": "string",
                    "example_values": [
                        "powershell.exe"
                    ],
                    "contains": [
                        "file name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.LastTimestamp",
                    "data_type": "string",
                    "example_values": [
                        "2021-09-15T22:53:50.2952649Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.PUAProtection",
                    "data_type": "string",
                    "example_values": [
                        "N/A"
                    ]
                },
                {
                    "data_path": "action_result.data.*.RealtimeProtection",
                    "data_type": "string",
                    "example_values": [
                        "N/A"
                    ]
                },
                {
                    "data_path": "action_result.data.*.SensorDataCollection",
                    "data_type": "string",
                    "example_values": [
                        "BAD"
                    ]
                },
                {
                    "data_path": "action_result.data.*.SensorEnabled",
                    "data_type": "string",
                    "example_values": [
                        "BAD"
                    ]
                },
                {
                    "data_path": "action_result.data.*.TamperProtection",
                    "data_type": "string",
                    "example_values": [
                        "N/A"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Timestamp",
                    "data_type": "string",
                    "example_values": [
                        "2021-09-15T10:53:13.5858707Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.UserName",
                    "data_type": "string",
                    "example_values": [
                        "administrator1"
                    ],
                    "contains": [
                        "user name"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_results",
                    "data_type": "numeric",
                    "example_values": [
                        7
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total results: 7"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "json"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get domain devices",
            "description": "Retrieve a collection of devices that have communicated to or from a given domain address",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-domain-related-machines?view=o365-worldwide\" target=\"_blank\">Get domain related machines API Documentation</a>), rate limitations for this action are 100 calls per minute and 1500 calls per hour. You can query on devices last updated according to your configured retention period.<br>The action retrieves data of the last 30 days.",
            "type": "investigate",
            "identifier": "get_domain_related_devices",
            "read_only": true,
            "parameters": {
                "domain": {
                    "description": "Domain to get the devices",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "domain"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.domain",
                    "data_type": "string",
                    "example_values": [
                        "test.com"
                    ],
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.aadDeviceId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.agentVersion",
                    "data_type": "string",
                    "example_values": [
                        "10.7740.19041.1110"
                    ]
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "testmachine4"
                    ]
                },
                {
                    "data_path": "action_result.data.*.defenderAvStatus",
                    "data_type": "string",
                    "example_values": [
                        "Updated"
                    ]
                },
                {
                    "data_path": "action_result.data.*.deviceValue",
                    "data_type": "string",
                    "example_values": [
                        "Normal"
                    ]
                },
                {
                    "data_path": "action_result.data.*.exposureLevel",
                    "data_type": "string",
                    "example_values": [
                        "Medium"
                    ]
                },
                {
                    "data_path": "action_result.data.*.firstSeen",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-02T06:12:16.3736341Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.healthStatus",
                    "data_type": "string",
                    "example_values": [
                        "Inactive"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "803c416946e8738b7711903a28362adeae6e1aea"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.ipAddress",
                    "data_type": "string",
                    "example_values": [
                        "10.1.1.4"
                    ],
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.macAddress",
                    "data_type": "string",
                    "example_values": [
                        "000X3X7X423X"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.operationalStatus",
                    "data_type": "string",
                    "example_values": [
                        "Up"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ipAddresses.*.type",
                    "data_type": "string",
                    "example_values": [
                        "Ethernet"
                    ]
                },
                {
                    "data_path": "action_result.data.*.isAadJoined",
                    "data_type": "boolean",
                    "example_values": [
                        false,
                        true
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastExternalIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "137.116.83.101"
                    ],
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "10.1.1.4"
                    ],
                    "contains": [
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastSeen",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-04T13:40:25.2473895Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.onboardingStatus",
                    "data_type": "string",
                    "example_values": [
                        "Onboarded"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osArchitecture",
                    "data_type": "string",
                    "example_values": [
                        "64-bit"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osBuild",
                    "data_type": "numeric",
                    "example_values": [
                        19042
                    ]
                },
                {
                    "data_path": "action_result.data.*.osPlatform",
                    "data_type": "string",
                    "example_values": [
                        "Windows10"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osProcessor",
                    "data_type": "string",
                    "example_values": [
                        "x64"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osVersion",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.rbacGroupId",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.rbacGroupName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.riskScore",
                    "data_type": "string",
                    "example_values": [
                        "Medium"
                    ]
                },
                {
                    "data_path": "action_result.data.*.version",
                    "data_type": "string",
                    "example_values": [
                        "20H2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.cloudProvider",
                    "data_type": "string",
                    "example_values": [
                        "TestCloudProvider"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.resourceId",
                    "data_type": "string",
                    "example_values": [
                        "/subscriptions/1b922e46-8595-4749-997a-1205e714cd91/resourceGroups/evaluation_3e5d447ba5d6470b9636a8709cd5b26a_4/providers/Test.Compute/virtualMachines/TestMachine4"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.subscriptionId",
                    "data_type": "string",
                    "example_values": [
                        "1b922e46-8595-4749-997a-1205e714cd91"
                    ]
                },
                {
                    "data_path": "action_result.data.*.vmMetadata.vmId",
                    "data_type": "string",
                    "example_values": [
                        "238443dc-56ce-487f-aeb6-261a2a00a38c"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_devices",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total devices: 1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "width": 10,
                "height": 5,
                "view": "windowsdefenderatp_view.display_devices",
                "title": "Get Domain Devices"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get discovered vulnerabilities",
            "description": "Retrieve a collection of discovered vulnerabilities related to a given device ID",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-discovered-vulnerabilities?view=o365-worldwide\" target=\"_blank\">Get discovered vulnerabilities API Documentation</a>), rate limitations for this API are 50 calls per minute and 1500 calls per hour.",
            "type": "investigate",
            "identifier": "get_discovered_vulnerabilities",
            "read_only": true,
            "parameters": {
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.cvssV3",
                    "data_type": "numeric",
                    "example_values": [
                        8.8
                    ],
                    "column_name": "CvssV3",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.description",
                    "data_type": "string",
                    "example_values": [
                        "Windows User Profile Service Elevation of Privilege Vulnerability"
                    ],
                    "column_name": "Description",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.exploitInKit",
                    "data_type": "numeric",
                    "example_values": [
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.exploitTypes",
                    "data_type": "string",
                    "example_values": [
                        "Local"
                    ]
                },
                {
                    "data_path": "action_result.data.*.exploitUris",
                    "data_type": "string",
                    "example_values": [
                        "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.exploitVerified",
                    "data_type": "numeric",
                    "example_values": [
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.exposedMachines",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ],
                    "column_name": "Exposed Machines",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "CVE-2021-30600"
                    ],
                    "column_name": "Vulnerability ID",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.name",
                    "data_type": "string",
                    "example_values": [
                        "CVE-2021-30600"
                    ],
                    "column_name": "Vulnerability Name",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.publicExploit",
                    "data_type": "numeric",
                    "example_values": [
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.publishedOn",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-16T00:00:00Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.severity",
                    "data_type": "string",
                    "example_values": [
                        "High"
                    ],
                    "column_name": "Severity",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.updatedOn",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-23T00:00:00Z"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_vulnerabilities",
                    "data_type": "numeric",
                    "example_values": [
                        7
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total vulnerabilities: 7"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "remove app restriction",
            "description": "Enable execution of any application on the device",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/unrestrict-code-execution?view=o365-worldwide\" target=\"_blank\">Remove app restriction API Documentation</a>), rate limitations for this API are 100 calls per minute and 1500 calls per hour.<br>This action can take a while to complete execution. The action retries at an interval of 5 seconds within a specified <b>timeout</b> to check if event execution is complete. If not, the action would return the latest status of the event along with the event ID.<br>The <b>get status</b> action can be used to fetch the latest status of the event with the event ID.<br>The maximum timeout period for a status check is 1 minute.",
            "type": "contain",
            "identifier": "remove_app_restriction",
            "read_only": false,
            "undo": "restrict app execution",
            "parameters": {
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 0
                },
                "comment": {
                    "description": "Comment",
                    "data_type": "string",
                    "required": true,
                    "order": 1
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 30)",
                    "data_type": "numeric",
                    "default": 30,
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "Unrestrict code execution since machine was cleaned and validated"
                    ],
                    "column_name": "Comment",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        30
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T08:50:05.8076226Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.externalId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "6925706d-3a7e-4596-b2d7-321fca9cd965"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T08:50:05.8076226Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "349838747f77ec74e43ab7ca70773a41f7bfb6f2"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.requestSource",
                    "data_type": "string",
                    "example_values": [
                        "PublicApi"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "65265db5-a7ca-4199-a425-f37ad1dd6d31"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "Unrestrict code execution since machine was cleaned and validated"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ],
                    "column_name": "Status",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.title",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.troubleshootInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "UnrestrictCodeExecution"
                    ],
                    "column_name": "Event Type",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "6925706d-3a7e-4596-b2d7-321fca9cd965"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.restriction_status",
                    "data_type": "string",
                    "example_values": [
                        "Pending"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event id: cd2ab57e-5b52-43b0-99d8-c370fc620a54, Restriction status: Succeeded"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get exposure score",
            "description": "Retrieve the organizational exposure score",
            "type": "investigate",
            "identifier": "get_exposure_score",
            "read_only": true,
            "parameters": {},
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#ExposureScore/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.rbacGroupId",
                    "data_type": "string",
                    "column_name": "RBAC Group ID",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.rbacGroupName",
                    "data_type": "string",
                    "column_name": "RBAC Group Name",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.score",
                    "data_type": "numeric",
                    "example_values": [
                        46.23333333333333
                    ],
                    "column_name": "Exposure Score",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.time",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-31T10:41:12.6341624Z"
                    ],
                    "column_name": "Time",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.summary.exposure_score",
                    "data_type": "numeric",
                    "example_values": [
                        46.23333333333333
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Exposure score: 46.23333333333333"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get secure score",
            "description": "Retrieve your Microsoft Secure Score for devices",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-device-secure-score?view=o365-worldwide\" target=\"_blank\">Get device secure score API Documentation</a>), a higher Microsoft Secure Score for devices means your endpoints are more resilient from cybersecurity threat attacks.",
            "type": "investigate",
            "identifier": "get_secure_score",
            "read_only": true,
            "parameters": {},
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#ConfigurationScore/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.rbacGroupId",
                    "data_type": "string",
                    "column_name": "RBAC Group ID",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.rbacGroupName",
                    "data_type": "string",
                    "column_name": "RBAC Group Name",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.score",
                    "data_type": "numeric",
                    "example_values": [
                        350
                    ],
                    "column_name": "Secure Score",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.time",
                    "data_type": "string",
                    "example_values": [
                        "2021-08-31T10:55:48.6805335Z"
                    ],
                    "column_name": "Time",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.summary.secure_score",
                    "data_type": "numeric",
                    "example_values": [
                        350
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Secure score: 350.0"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get file",
            "description": "Download a file from a device using live response",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/run-live-response?view=o365-worldwide\" target=\"_blank\">Run live response commands on a device API Documentation</a>), the user can collect file from a device in the vault, rate limitations for this API are 10 calls per minute.<br>The action tries to get the file using file_path along with the device_id. This action can take a while to complete the execution. The action retries at an interval of 5 seconds within a specified timeout to check if event execution is completed. If not, the action would return the latest status of the event along with the event ID. The get status action can be used to fetch the latest status of the event with the event ID. If the status is 'Succeeded', the event ID can be used in the same action to get the file. If all the parameters are given, the action gives higher priority to the event ID parameter.<br><br><b>Notes:</b><ul><li>Live response actions cannot be queued up and can only be executed one at a time.</li><li>If the machine that you are trying to run this action is in an RBAC device group that does not have an automated remediation level assigned to it, you'll need to at least enable the minimum Remediation Level for a given Device Group.</li></ul>",
            "type": "generic",
            "identifier": "get_file_live_response",
            "read_only": false,
            "parameters": {
                "event_id": {
                    "description": "ID of the event",
                    "data_type": "string",
                    "primary": true,
                    "order": 0,
                    "contains": [
                        "defender atp event id"
                    ]
                },
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 1
                },
                "file_path": {
                    "description": "Path of the file to download from device",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "file path"
                    ],
                    "order": 2
                },
                "comment": {
                    "description": "Comment",
                    "data_type": "string",
                    "order": 3
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 300)",
                    "data_type": "numeric",
                    "order": 4
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "Testing get file live response"
                    ]
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.event_id",
                    "data_type": "string",
                    "example_values": [
                        "f4ddc97a-6f4e-471c-9be5-45e0d6d64ab8"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.parameter.file_path",
                    "data_type": "string",
                    "example_values": [
                        "C:\\Users\\administrator1\\Desktop\\Test\\one.txt"
                    ],
                    "contains": [
                        "file path"
                    ],
                    "column_name": "File Path",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        300
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.commands.*.command.params.*.key",
                    "data_type": "string",
                    "example_values": [
                        "Path"
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.command.params.*.value",
                    "data_type": "string",
                    "example_values": [
                        "C:\\Users\\administrator1\\Desktop\\test\\one.txt"
                    ],
                    "contains": [
                        "file path"
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.command.type",
                    "data_type": "string",
                    "example_values": [
                        "GetFile"
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.commandStatus",
                    "data_type": "string",
                    "example_values": [
                        "Completed"
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.endTime",
                    "data_type": "string",
                    "example_values": [
                        "2021-09-01T09:20:33.353Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.index",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.startTime",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "testmachine7"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2021-09-01T09:17:58.4219929Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.externalId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "81238f5f-f525-4b33-85e1-4460c5465ea4"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2021-09-01T09:21:19.11422Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "51e978e9c3cd646dde81162f0517f13b8697cfcb"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.requestSource",
                    "data_type": "string",
                    "example_values": [
                        "PublicApi"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "65265db5-a7ca-4199-a425-f37ad1dd6d31"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "test"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ]
                },
                {
                    "data_path": "action_result.data.*.title",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.troubleshootInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "LiveResponse"
                    ]
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "6925706d-3a7e-4596-b2d7-321fca9cd965"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.summary.event_id_status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ]
                },
                {
                    "data_path": "action_result.summary.file_status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ]
                },
                {
                    "data_path": "action_result.summary.live_response_result",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.vault_id",
                    "data_type": "string",
                    "example_values": [
                        "7553f175dbbfa2f0830bebe8c367fe68fd40a9a4"
                    ],
                    "contains": [
                        "vault id"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully added file to vault. vault_id: 7553f175dbbfa2f0830bebe8c367fe68fd40a9a4"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "put file",
            "description": "Put a file from the library to a device using live response",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/run-live-response?view=o365-worldwide\" target=\"_blank\">Run live response commands on a device API Documentation</a>), the user can put a file from the library to the device, rate limitations for this API are 10 calls per minute.<br>This action can take a while to complete execution. The action retries at an interval of 5 seconds within a specified <b>timeout</b> to check if event execution is complete. If not, the action would return the latest status of the event along with the event ID.<br>The <b>get status</b> action can be used to fetch the latest status of the event with the event ID.<br><b>Notes:</b><ul><li>Live response actions cannot be queued up and can only be executed one at a time.</li><li>If the machine that you are trying to run this action is in an RBAC device group that does not have an automated remediation level assigned to it, you'll need to at least enable the minimum Remediation Level for a given Device Group.</li></ul>",
            "type": "generic",
            "identifier": "put_file_live_response",
            "read_only": false,
            "parameters": {
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 0
                },
                "file_name": {
                    "description": "Name of the file",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "file name"
                    ],
                    "order": 1
                },
                "comment": {
                    "description": "Comment",
                    "data_type": "string",
                    "required": true,
                    "order": 2
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 300)",
                    "data_type": "numeric",
                    "default": 300,
                    "order": 3
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "Testing put file live response"
                    ]
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768"
                    ],
                    "contains": [
                        "defender atp device id"
                    ],
                    "column_name": "Device ID",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.file_name",
                    "data_type": "string",
                    "example_values": [
                        "one.txt"
                    ],
                    "contains": [
                        "file name"
                    ],
                    "column_name": "File Name",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        300
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.commands.*.command.params.*.key",
                    "data_type": "string",
                    "example_values": [
                        "FileName"
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.command.params.*.value",
                    "data_type": "string",
                    "example_values": [
                        "one.txt"
                    ],
                    "contains": [
                        "file name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.command.type",
                    "data_type": "string",
                    "example_values": [
                        "PutFile"
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.commandStatus",
                    "data_type": "string",
                    "example_values": [
                        "Completed"
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.endTime",
                    "data_type": "string",
                    "example_values": [
                        "2021-09-01T06:43:33.717Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.index",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.commands.*.startTime",
                    "data_type": "string",
                    "example_values": [
                        "2021-09-01T06:43:32.42Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "testmachine7"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2021-09-01T06:40:58.9203082Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.externalId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "30f736e4-1538-46ca-b21f-8f315b096077"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2021-09-01T06:44:17.161248Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "51e978e9c3cd646dde81162f0517f13b8697cfcb"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.requestSource",
                    "data_type": "string",
                    "example_values": [
                        "PublicApi"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "65265db5-a7ca-4199-a425-f37ad1dd6d31"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "putfile"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ],
                    "column_name": "Status",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.title",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.troubleshootInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "LiveResponse"
                    ]
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "6925706d-3a7e-4596-b2d7-321fca9cd965"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.put_file_status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event id: 30f736e4-1538-46ca-b21f-8f315b096077, Put file status: Succeeded"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "run script",
            "description": "Run a script from the library on a device using live response",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/run-live-response?view=o365-worldwide\" target=\"_blank\">Run live response commands on a device API Documentation</a>), the user can run a script from the library on a device. The script_args parameter is passed to your script, rate limitations for this API are 10 calls per minute.<br>The action tries to execute the script using script_name along with the device_id. This action can take a while to complete the execution. The action retries at an interval of 5 seconds within a specified timeout to check if event execution is completed. If not, the action would return the latest status of the event along with the event ID. The get status action can be used to fetch the latest status of the event with the event ID. If the status is 'Succeded', the event ID can be used in the same action to get the script output. If all the parameters are given, the action gives higher priority to the event ID parameter.<br><br><b>Notes:</b><ul><li>The maximum timeout period for the script execution is 10 minutes.</li><li>Live response actions cannot be queued up and can only be executed one at a time.</li><li>If the machine that you are trying to run this action is in an RBAC device group that does not have an automated remediation level assigned to it, you'll need to at least enable the minimum Remediation Level for a given Device Group.</li></ul>",
            "type": "generic",
            "identifier": "run_script_live_response",
            "read_only": false,
            "parameters": {
                "event_id": {
                    "description": "ID of the event",
                    "data_type": "string",
                    "primary": true,
                    "order": 0,
                    "contains": [
                        "defender atp event id"
                    ]
                },
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 1
                },
                "script_name": {
                    "description": "Name of the script file to execute on the device",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "file name"
                    ],
                    "order": 2
                },
                "script_args": {
                    "description": "Arguments of the script file",
                    "data_type": "string",
                    "order": 3
                },
                "comment": {
                    "description": "Comment",
                    "data_type": "string",
                    "order": 4
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 300)",
                    "data_type": "numeric",
                    "order": 5
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "Testing live response for run script"
                    ]
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.parameter.event_id",
                    "data_type": "string",
                    "example_values": [
                        "f4ddc97a-6f4e-471c-9be5-45e0d6d64ab8"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.parameter.script_args",
                    "data_type": "string",
                    "example_values": [
                        "OfficeClickToRun"
                    ]
                },
                {
                    "data_path": "action_result.parameter.script_name",
                    "data_type": "string",
                    "example_values": [
                        "minidump.ps1"
                    ],
                    "contains": [
                        "file name"
                    ]
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        300
                    ]
                },
                {
                    "data_path": "action_result.data.*.exit_code",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.script_errors",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.script_name",
                    "data_type": "string",
                    "example_values": [
                        "script4.ps1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.script_output",
                    "data_type": "string",
                    "example_values": [
                        "Transcript started, output file is C:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Temp\\PSScriptOutputs\\PSScript_Transcript_{66D7B239-34C7-43EF-BB6D-2F6D4C03086E}.txt x is smaller than y"
                    ]
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "6925706d-3a7e-4596-b2d7-321fca9cd965"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.live_response_result",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.script_status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully executed script"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "width": 10,
                "height": 5,
                "view": "windowsdefenderatp_view.run_script",
                "title": "Run Script"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get missing kbs",
            "description": "Retrieve missing KBs (security updates) by given device ID",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-missing-kbs-machine?view=o365-worldwide\" target=\"_blank\">Get missing KBs API Documentation</a>), the user can retrieve a collection of missing security updated related to a given device ID.",
            "type": "investigate",
            "identifier": "get_missing_kbs",
            "read_only": true,
            "parameters": {
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "defender atp device id"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768"
                    ],
                    "contains": [
                        "defender atp device id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cveAddressed",
                    "data_type": "numeric",
                    "example_values": [
                        26
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "5005033"
                    ],
                    "column_name": "KB ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.machineMissedOn",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.name",
                    "data_type": "string",
                    "example_values": [
                        "August 2021 Security Updates"
                    ],
                    "column_name": "KB Name",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.osBuild",
                    "data_type": "numeric",
                    "example_values": [
                        19042
                    ]
                },
                {
                    "data_path": "action_result.data.*.productsNames",
                    "data_type": "string",
                    "example_values": [
                        "windows_10"
                    ]
                },
                {
                    "data_path": "action_result.data.*.url",
                    "data_type": "string",
                    "example_values": [
                        "https://catalog.update.microsoft.com/v7/site/Search.aspx?q=KB5005033"
                    ],
                    "contains": [
                        "url"
                    ],
                    "column_name": "URL",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.summary.total_kbs",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total KBs: 1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        }
    ]
}