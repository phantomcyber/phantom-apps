{
    "appid": "e85407b7-91f0-4019-8fa4-0d29bca741d5",
    "name": "Windows Defender ATP",
    "description": "This app integrates with Windows Defender Advanced Threat Protection(ATP) to execute various containment, corrective and investigative actions",
    "type": "endpoint",
    "product_vendor": "Microsoft",
    "logo": "logo_windowsdefenderatp.svg",
    "logo_dark": "logo_windowsdefenderatp_dark.svg",
    "product_name": "Windows Defender ATP",
    "product_version_regex": ".*",
    "publisher": "Splunk",
    "license": "Copyright (c) 2019-2021 Splunk Inc.",
    "app_version": "3.1.0",
    "utctime_updated": "2021-02-22T13:50:38.000000Z",
    "package_name": "phantom_windowsdefenderatp",
    "main_module": "windowsdefenderatp_connector.py",
    "python_version": "3",
    "min_phantom_version": "4.9.39220",
    "app_wizard_version": "1.0.0",
    "latest_tested_versions": [
        "Cloud November 2020 Release"
    ],
    "rest_handler": "windowsdefenderatp_connector._handle_rest_request",
    "configuration": {
        "tenant_id": {
            "description": "Tenant ID",
            "data_type": "string",
            "required": true,
            "order": 0
        },
        "ph": {
            "data_type": "ph",
            "order": 1
        },
        "client_id": {
            "description": "Client ID",
            "data_type": "string",
            "required": true,
            "order": 2
        },
        "client_secret": {
            "description": "Client Secret",
            "data_type": "password",
            "required": true,
            "order": 3
        },
        "non_interactive": {
            "description": "Non Interactive Auth",
            "data_type": "boolean",
            "default": false,
            "order": 4
        }
    },
    "actions": [
        {
            "action": "test connectivity",
            "description": "Validate the asset configuration for connectivity using the supplied configuration",
            "type": "test",
            "identifier": "test_connectivity",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "quarantine device",
            "description": "Quarantine the device",
            "verbose": "This action can take a while to complete execution. The action retries at an interval of 5 seconds within a specified <b>timeout</b> to check if event execution is complete. If not, the action would return the latest status of the event along with event ID.<br>The <b>get status</b> action can be used to fetch the latest status of the event with the event ID.<br>For parameter <i>type</i>, <b>&quotFull&quot</b> will completely quarantine the device while <b>&quotSelective&quot</b> will allow Skype and Outlook to be accessed.<br>The maximum timeout period for a status check is 10 minutes.",
            "type": "contain",
            "identifier": "quarantine_device",
            "read_only": false,
            "parameters": {
                "device_id": {
                    "description": "ID of the device to quarantine",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1"
                    ],
                    "order": 0
                },
                "type": {
                    "description": "Type of quarantine (Default: Full)",
                    "data_type": "string",
                    "required": true,
                    "value_list": [
                        "Full",
                        "Selective"
                    ],
                    "default": "Full",
                    "order": 1
                },
                "comment": {
                    "description": "Comment for quarantine",
                    "data_type": "string",
                    "required": true,
                    "order": 2
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 30)",
                    "data_type": "numeric",
                    "default": 30,
                    "order": 3
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "selective quarantine",
                        "test"
                    ],
                    "column_name": "Comment",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768",
                        "349838747f77ec74e43ab7ca70773a41f7bfb6f2"
                    ],
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        30,
                        130
                    ]
                },
                {
                    "data_path": "action_result.parameter.type",
                    "data_type": "string",
                    "example_values": [
                        "Selective",
                        "Full"
                    ],
                    "column_name": "Quarantine Type",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2018-07-10T12:30:33.8322656Z",
                        "2019-05-03T08:50:05.8076226Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "6925706d-3a7e-4596-b2d7-321fca9cd965"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T08:50:05.8076226Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "349838747f77ec74e43ab7ca70773a41f7bfb6f2"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "testuser@example.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "Selective",
                        "test"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string",
                    "example_values": [
                        "Full"
                    ]
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded",
                        "InProgress",
                        "Pending"
                    ],
                    "column_name": "Quarantine Status",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "Isolate"
                    ],
                    "column_name": "Event Type",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "6925706d-3a7e-4596-b2d7-321fca9cd965"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.quarantine_status",
                    "data_type": "string",
                    "example_values": [
                        "InProgress",
                        "Pending"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event id: 6925706d-3a7e-4596-b2d7-321fca9cd965, Quarantine status: Pending"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "unquarantine device",
            "description": "Unquarantine the device",
            "verbose": "This action can take a while to complete execution. The action retries at an interval of 5 seconds within a specified <b>timeout</b> to check if event execution is complete. If not, the action would return the latest status of the event along with event ID.<br>The <b>get status</b> action can be used to fetch the latest status of the event with the event ID.<br>The maximum timeout period for a status check is 10 minutes.",
            "type": "correct",
            "identifier": "unquarantine_device",
            "read_only": false,
            "parameters": {
                "device_id": {
                    "description": "ID of the device to unquarantine",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1"
                    ],
                    "order": 0
                },
                "comment": {
                    "description": "Comment for unquarantine",
                    "data_type": "string",
                    "required": true,
                    "order": 1
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 30)",
                    "data_type": "numeric",
                    "default": 30,
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "unquarantine the device",
                        "test"
                    ],
                    "column_name": "Comment",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "349838747f77ec74e43ab7ca70773a41f7bfb6f2"
                    ],
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        30
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T08:52:22.7708738Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "cb15e6e0-1d53-4762-9c37-f14d412ece9e"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T08:52:22.7708738Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "349838747f77ec74e43ab7ca70773a41f7bfb6f2"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "testuser@example.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "isolation",
                        "test"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "InProgress",
                        "Pending"
                    ],
                    "column_name": "Unquarantine Status",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "Unisolate"
                    ],
                    "column_name": "Event Type",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "cb15e6e0-1d53-4762-9c37-f14d412ece9e"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.unquarantine_status",
                    "data_type": "string",
                    "example_values": [
                        "Pending"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event id: cb15e6e0-1d53-4762-9c37-f14d412ece9e, Unquarantine status: Pending"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get status",
            "description": "Get status of the event on a machine",
            "type": "investigate",
            "identifier": "get_status",
            "read_only": true,
            "parameters": {
                "event_id": {
                    "description": "ID of the event",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "order": 0,
                    "contains": [
                        "defender atp event id"
                    ]
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.event_id",
                    "data_type": "string",
                    "example_values": [
                        "f4ddc97a-6f4e-471c-9be5-45e0d6d64ab8"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T09:01:19.3478911Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.fileInstances",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "f4ddc97a-6f4e-471c-9be5-45e0d6d64ab8"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T09:01:27.6955788Z"
                    ],
                    "column_name": "Last Update Time",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "ae2e5bda4bb22ec9c321680079d03e5e4cdff400"
                    ],
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "Device ID",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo.fileIdentifier",
                    "data_type": "string",
                    "example_values": [
                        "2dba4c14a5e97312f9edf617e1c8b0cc0d387fd8"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo.fileIdentifierType",
                    "data_type": "string",
                    "example_values": [
                        "Sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "test.user@example.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ],
                    "column_name": "Requestor",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "test"
                    ],
                    "column_name": "Comment",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.sha1",
                    "data_type": "string",
                    "example_values": [
                        "11ffeabbe42159e1365aa82463d8690c845ce7b7"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ],
                    "column_name": "Event Status",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "RunAntiVirusScan",
                        "Isolate"
                    ],
                    "column_name": "Event Type",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.summary.event_status",
                    "data_type": "string",
                    "example_values": [
                        "Succeeded"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event status: Succeeded"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "scan device",
            "description": "Scan a device for virus",
            "verbose": "This action can take a while to complete execution. The action retries at an interval of 5 seconds within a specified <b>timeout</b> to check if event execution is complete. If not, the action would return the latest status of the event along with event ID.<br>The <b>get status</b> action can be used to fetch the latest status of the event with the event ID.<br>The maximum timeout period for a status check is 1 hour.",
            "type": "investigate",
            "identifier": "scan_device",
            "read_only": true,
            "parameters": {
                "device_id": {
                    "description": "ID of the device to scan",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1"
                    ],
                    "order": 0
                },
                "scan_type": {
                    "description": "Type of scan",
                    "data_type": "string",
                    "required": true,
                    "value_list": [
                        "Quick",
                        "Full"
                    ],
                    "default": "Quick",
                    "order": 1
                },
                "comment": {
                    "description": "Comment for scan",
                    "data_type": "string",
                    "required": true,
                    "order": 2
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 30)",
                    "data_type": "numeric",
                    "default": 30,
                    "order": 3
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "column_name": "Comment",
                    "column_order": 2,
                    "example_values": [
                        "Scanning from Test"
                    ]
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0,
                    "example_values": [
                        "a3627cbcad1e9ca2dd94eed63e3f9260e2aa7e8e"
                    ]
                },
                {
                    "data_path": "action_result.parameter.scan_type",
                    "data_type": "string",
                    "column_name": "Scan Type",
                    "column_order": 1,
                    "example_values": [
                        "Quick"
                    ]
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        30
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2018-07-12T11:35:30.8573959Z"
                    ],
                    "column_name": "Creation Time",
                    "column_order": 7
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "34a0905e-316b-46eb-994d-c7d0e8ac2efb"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2018-07-12T11:35:30.8573959Z"
                    ],
                    "column_name": "Last Update Time",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "a3627cbcad1e9ca2dd94eed63e3f9260e2aa7e8e"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "testuser@example.com"
                    ],
                    "contains": [
                        "email"
                    ],
                    "column_name": "Requestor",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "From Test"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string",
                    "example_values": [
                        "Quick"
                    ]
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "InProgress",
                        "Pending"
                    ],
                    "column_name": "Scan Status",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "RunAntiVirusScan"
                    ]
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "34a0905e-316b-46eb-994d-c7d0e8ac2efb"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.scan_status",
                    "data_type": "string",
                    "example_values": [
                        "InProgress"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event id: 34a0905e-316b-46eb-994d-c7d0e8ac2efb, Scan status: InProgress"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "quarantine file",
            "description": "Quarantine a file",
            "verbose": "This action can take a while to complete execution. The action retries at an interval of 5 seconds within a specified <b>timeout</b> to check if event execution is complete. If not, the action would return the latest status of the event along with event ID.<br>The <b>get status</b> action can be used to fetch the latest status of the event with the event ID.<br>The maximum timeout period for a status check is 10 minutes.",
            "type": "contain",
            "identifier": "quarantine_file",
            "read_only": false,
            "parameters": {
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1"
                    ],
                    "order": 0
                },
                "file_hash": {
                    "description": "Identifier of the file",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1"
                    ],
                    "order": 1
                },
                "comment": {
                    "description": "Comment for quarantine",
                    "data_type": "string",
                    "required": true,
                    "order": 2
                },
                "timeout": {
                    "description": "Timeout in seconds (Default: 30)",
                    "data_type": "numeric",
                    "default": 30,
                    "order": 3
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "example_values": [
                        "Test comment for file quarantine"
                    ],
                    "column_name": "Comment",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "ae2e5bda4bb22ec9c321680079d03e5e4cdff400"
                    ],
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.file_hash",
                    "data_type": "string",
                    "example_values": [
                        "2dba4c14a5e97312f9edf617e1c8b0cc0d387fd8"
                    ],
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "File Hash",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.timeout",
                    "data_type": "numeric",
                    "example_values": [
                        30,
                        125
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://api.securitycenter.windows.com/api/$metadata#MachineActions/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.cancellationComment",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationDateTimeUtc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.cancellationRequestor",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.creationDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T06:00:00.2740597Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.error",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.errorHResult",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.fileId",
                    "data_type": "string",
                    "example_values": [
                        "e1049556edc2b28ef25b2932c722e4dc927e9d04"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.fileInstances.*.filePath",
                    "data_type": "string",
                    "contains": [
                        "file path"
                    ]
                },
                {
                    "data_path": "action_result.data.*.fileInstances.*.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "76e82ecd-54b8-400d-83be-a05d582b3546"
                    ],
                    "contains": [
                        "defender atp event id"
                    ],
                    "column_name": "Event ID",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.lastUpdateDateTimeUtc",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T06:00:00.2740597Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "ae2e5bda4bb22ec9c321680079d03e5e4cdff400"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo.fileIdentifier",
                    "data_type": "string",
                    "example_values": [
                        "2dba4c14a5e97312f9edf617e1c8b0cc0d387fd8"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.relatedFileInfo.fileIdentifierType",
                    "data_type": "string",
                    "example_values": [
                        "Sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestor",
                    "data_type": "string",
                    "example_values": [
                        "testuser@example.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.requestorComment",
                    "data_type": "string",
                    "example_values": [
                        "file quarantine"
                    ]
                },
                {
                    "data_path": "action_result.data.*.scope",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.sha1",
                    "data_type": "string",
                    "example_values": [
                        "e1049556edc2b28ef25b2932c722e4dc927e9d04"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Pending"
                    ],
                    "column_name": "Quarantine Status",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.type",
                    "data_type": "string",
                    "example_values": [
                        "StopAndQuarantineFile"
                    ],
                    "column_name": "Event Type",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.summary.event_id",
                    "data_type": "string",
                    "example_values": [
                        "76e82ecd-54b8-400d-83be-a05d582b3546"
                    ],
                    "contains": [
                        "defender atp event id"
                    ]
                },
                {
                    "data_path": "action_result.summary.quarantine_status",
                    "data_type": "string",
                    "example_values": [
                        "InProgress"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Event id: 76e82ecd-54b8-400d-83be-a05d582b3546, Quarantine status: Pending"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list devices",
            "description": "List of recently seen devices",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/get-machines\" target=\"_blank\">List Machines API Documentation</a>), the user can get devices last seen in the past 30 days; the maximum page size is 10,000; rate limitations for this action are 100 calls per minute and 1500 calls per hour. If the user does not specify the limit value, it will fetch 100 devices by default.",
            "type": "investigate",
            "identifier": "list_devices",
            "read_only": true,
            "parameters": {
                "input_type": {
                    "description": "Type of input (Default: All)",
                    "data_type": "string",
                    "order": 0,
                    "required": true,
                    "value_list": [
                        "All",
                        "Domain",
                        "File Hash"
                    ],
                    "default": "All"
                },
                "input": {
                    "description": "Input filter of type Domain, File hash or All",
                    "data_type": "string",
                    "order": 1,
                    "primary": true,
                    "contains": [
                        "sha1",
                        "sha256",
                        "md5",
                        "domain"
                    ]
                },
                "query": {
                    "description": "Additional OData V4 filters to apply",
                    "data_type": "string",
                    "order": 2
                },
                "limit": {
                    "description": "Maximum number of devices to return (Maximum: 10,000)",
                    "data_type": "numeric",
                    "default": 100,
                    "order": 3
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.input",
                    "data_type": "string",
                    "example_values": [
                        "filehash"
                    ],
                    "contains": [
                        "sha1",
                        "sha256",
                        "md5",
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.parameter.input_type",
                    "data_type": "string",
                    "example_values": [
                        "All"
                    ]
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric",
                    "example_values": [
                        100
                    ]
                },
                {
                    "data_path": "action_result.parameter.query",
                    "data_type": "string",
                    "example_values": [
                        "$filter=riskScore+eq+'High'"
                    ]
                },
                {
                    "data_path": "action_result.data.*.aadDeviceId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.agentVersion",
                    "data_type": "string",
                    "example_values": [
                        "10.4850.17134.1",
                        "10.5850.17763.404"
                    ]
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "desktop-ph2a1ro",
                        "desktop-hq2fctd"
                    ],
                    "contains": [
                        "domain"
                    ],
                    "column_name": "Computer Name",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.exposureLevel",
                    "data_type": "string",
                    "example_values": [
                        "Medium"
                    ]
                },
                {
                    "data_path": "action_result.data.*.firstSeen",
                    "data_type": "string",
                    "example_values": [
                        "2019-04-16T00:27:12.2677222Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.groupName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.healthStatus",
                    "data_type": "string",
                    "example_values": [
                        "Active"
                    ],
                    "column_name": "Health Status",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "ae2e5bda4bb22ec9c321680079d03e5e4cdff400"
                    ],
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.isAadJoined",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastExternalIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "203.88.139.34",
                        "204.107.141.240"
                    ],
                    "contains": [
                        "ip"
                    ],
                    "column_name": "Last External IP Address",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.lastIpAddress",
                    "data_type": "string",
                    "example_values": [
                        "10.0.1.87",
                        "10.1.66.140"
                    ],
                    "contains": [
                        "ip"
                    ],
                    "column_name": "Last IP Address",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.lastSeen",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T05:23:45.9643247Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineTags",
                    "data_type": "string",
                    "example_values": [
                        "Test Tag -21"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osBuild",
                    "data_type": "numeric",
                    "example_values": [
                        17134,
                        17763
                    ]
                },
                {
                    "data_path": "action_result.data.*.osPlatform",
                    "data_type": "string",
                    "example_values": [
                        "Windows10"
                    ],
                    "column_name": "OS",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.osProcessor",
                    "data_type": "string",
                    "example_values": [
                        "x64"
                    ]
                },
                {
                    "data_path": "action_result.data.*.osVersion",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.rbacGroupId",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.rbacGroupName",
                    "data_type": "string",
                    "example_values": [
                        "GROUP1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.riskScore",
                    "data_type": "string",
                    "example_values": [
                        "None"
                    ]
                },
                {
                    "data_path": "action_result.data.*.systemProductName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.version",
                    "data_type": "string",
                    "example_values": [
                        "1809"
                    ]
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_devices",
                    "data_type": "numeric",
                    "example_values": [
                        2
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total devices: 2"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list alerts",
            "description": "List all alerts of a given type",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/get-alerts\" target=\"_blank\">List Alerts API Documentation</a>), the user can get alerts last updated in the past 30 days; the maximum page size is 10,000; rate limitations for this action are 100 calls per minute and 1500 calls per hour. If the user does not specify the limit value, it will fetch 100 devices by default.",
            "type": "investigate",
            "identifier": "list_alerts",
            "read_only": true,
            "parameters": {
                "input_type": {
                    "description": "Type of input (Default: All)",
                    "data_type": "string",
                    "value_list": [
                        "All",
                        "Domain",
                        "File Hash",
                        "IP"
                    ],
                    "default": "All",
                    "order": 0
                },
                "input": {
                    "description": "Input filter of type Domain, File Hash and IP",
                    "data_type": "string",
                    "primary": true,
                    "contains": [
                        "domain",
                        "sha1",
                        "sha256",
                        "md5",
                        "ip"
                    ],
                    "order": 1
                },
                "limit": {
                    "description": "Maximum number of alerts to return (Maximum: 10,000)",
                    "data_type": "numeric",
                    "default": 100,
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.input",
                    "data_type": "string",
                    "example_values": [
                        "1b3b40fbc889fd4c645cc12c85d0805ac36ba254",
                        "fda7:e6ee:2e09:0:19f9:12ea:c80d:cf5b",
                        "google.com"
                    ],
                    "contains": [
                        "domain",
                        "sha1",
                        "sha256",
                        "md5",
                        "ip"
                    ]
                },
                {
                    "data_path": "action_result.parameter.input_type",
                    "data_type": "string",
                    "example_values": [
                        "All",
                        "Domain",
                        "File Hash",
                        "IP"
                    ]
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric",
                    "example_values": [
                        100
                    ]
                },
                {
                    "data_path": "action_result.data.*.aadTenantId",
                    "data_type": "string",
                    "example_values": [
                        "7810-b62a-4fc0-bbbb-20165d183d7f"
                    ]
                },
                {
                    "data_path": "action_result.data.*.alertCreationTime",
                    "data_type": "string",
                    "example_values": [
                        "2018-07-06T06:14:57.3215921Z",
                        "2019-05-03T01:20:51.8699882Z"
                    ],
                    "column_name": "Creation Time",
                    "column_order": 7
                },
                {
                    "data_path": "action_result.data.*.assignedTo",
                    "data_type": "string",
                    "example_values": [
                        "testuser@example.com",
                        "Automation"
                    ],
                    "contains": [
                        "email"
                    ],
                    "column_name": "Assigned To",
                    "column_order": 8
                },
                {
                    "data_path": "action_result.data.*.category",
                    "data_type": "string",
                    "example_values": [
                        "General"
                    ],
                    "column_name": "Category",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.classification",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.comments.*.comment",
                    "data_type": "string",
                    "example_values": [
                        "test"
                    ]
                },
                {
                    "data_path": "action_result.data.*.comments.*.createdBy",
                    "data_type": "string",
                    "example_values": [
                        "test@example.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.comments.*.createdTime",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-01T13:21:37.869889Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.computerDnsName",
                    "data_type": "string",
                    "example_values": [
                        "win10atp1"
                    ],
                    "column_name": "Computer DNS Name",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.description",
                    "data_type": "string",
                    "example_values": [
                        "Malware and unwanted software are undesirable applications that perform annoying, disruptive or harmful actions on affected machines. Some of these undesirable applications can replicate and spread from one machine to another. Others can able to receive commands from remote attackers and perform activities associated with cyber attacks. This detection might indicate that Windows Defender has stopped the malware from delivering its payload. However, it is prudent to check the machine for signs of infection."
                    ]
                },
                {
                    "data_path": "action_result.data.*.detectionSource",
                    "data_type": "string",
                    "example_values": [
                        "WindowsDefenderAv"
                    ]
                },
                {
                    "data_path": "action_result.data.*.determination",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.firstEventTime",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-02T23:03:43.2077683Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "636924432519012302_1685044642"
                    ],
                    "column_name": "Alert ID",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.incidentId",
                    "data_type": "numeric",
                    "example_values": [
                        11
                    ]
                },
                {
                    "data_path": "action_result.data.*.investigationId",
                    "data_type": "numeric",
                    "example_values": [
                        10
                    ]
                },
                {
                    "data_path": "action_result.data.*.investigationState",
                    "data_type": "string",
                    "example_values": [
                        "Benign"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastEventTime",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-02T23:03:43.2077683Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastUpdateTime",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T01:29:51.9233333Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.machineId",
                    "data_type": "string",
                    "example_values": [
                        "ae2e5bda4bb22ec9c321680079d03e5e4cdff400"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.recommendedAction",
                    "data_type": "string",
                    "example_values": [
                        "Collect artifacts and determine scope Review the machine timeline for suspicious activities that may have occurred before and after the time of the alert, and record additional related artifacts (files, IPs/URLs) Look for the presence of relevant artifacts on other systems. Identify commonalities and differences between potentially compromised systems. Submit relevant files for deep analysis and review resulting in detailed behavioral information. Submit undetected files to the MMPC malware portal Initiate containment & mitigation Contact the user to verify intent and initiate local remediation actions as needed. Update AV signatures and run a full scan. The scan might reveal and remove previously-undetected malware components. Ensure that the machine has the latest security updates. In particular, ensure that you have installed the latest software, web browser, and Operating System versions. If credential theft is suspected, reset all relevant users' passwords. Block communication with relevant URLs or IPs at the organization's perimeter."
                    ]
                },
                {
                    "data_path": "action_result.data.*.resolvedTime",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-03T01:29:51.7614303Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.severity",
                    "data_type": "string",
                    "example_values": [
                        "Informational"
                    ],
                    "column_name": "Severity",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.status",
                    "data_type": "string",
                    "example_values": [
                        "Resolved"
                    ],
                    "column_name": "Status",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.threatFamilyName",
                    "data_type": "string",
                    "example_values": [
                        "EICAR_Test_File",
                        "Fuery"
                    ],
                    "column_name": "Threat Family",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.title",
                    "data_type": "string",
                    "example_values": [
                        "Windows Defender AV detected 'Fuery' malware"
                    ],
                    "column_name": "Title",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_alerts",
                    "data_type": "numeric",
                    "example_values": [
                        7,
                        12
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total alerts: 12"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list sessions",
            "description": "List all logged in users on a machine",
            "verbose": "Based on the link (<a href=\"https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/get-machine-log-on-users\" target=\"_blank\">List Sessions API Documentation</a>), the user can query on machines last seen in the past 30 days; rate limitations for this action are 100 calls per minute and 1500 calls per hour.",
            "type": "investigate",
            "identifier": "list_sessions",
            "read_only": true,
            "parameters": {
                "device_id": {
                    "description": "ID of the device",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "sha1"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.device_id",
                    "data_type": "string",
                    "example_values": [
                        "7af22c8a3f92ec0c9c49b80aee3379bf9bfa0768"
                    ],
                    "contains": [
                        "sha1"
                    ],
                    "column_name": "Device ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.accountDomain",
                    "data_type": "string",
                    "example_values": [
                        "win10atp1"
                    ],
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.accountDomainName",
                    "data_type": "string",
                    "example_values": [
                        "desktop-gq5jf56"
                    ],
                    "contains": [
                        "domain"
                    ],
                    "column_name": "Account Domain Name",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.accountName",
                    "data_type": "string",
                    "example_values": [
                        "example"
                    ],
                    "column_name": "Account Name",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.accountSid",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.firstSeen",
                    "data_type": "string",
                    "example_values": [
                        "2018-07-06T00:00:00Z"
                    ],
                    "column_name": "First Seen",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "desktop-gq5jf56\\example"
                    ],
                    "column_name": "User ID",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.isDomainAdmin",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ],
                    "column_name": "Domain Admin",
                    "column_order": 4,
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.isOnlyNetworkUser",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.lastSeen",
                    "data_type": "string",
                    "example_values": [
                        "2018-07-06T00:00:00Z"
                    ],
                    "column_name": "Last Seen",
                    "column_order": 6
                },
                {
                    "data_path": "action_result.data.*.leastPrevalentMachineId",
                    "data_type": "string",
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.logOnMachinesCount",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.logonTypes",
                    "data_type": "string",
                    "example_values": [
                        "Network, RemoteInteractive"
                    ]
                },
                {
                    "data_path": "action_result.data.*.mostPrevalentMachineId",
                    "data_type": "string",
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_sessions",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total sessions: 1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        }
    ]
}