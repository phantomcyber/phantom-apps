{% extends 'widgets/widget_template.html' %}
{% load custom_template %}

{% block title_color %}{{ title_color|default:'white' }}{% endblock %}
{% block title_text_color %}{{ title_text_color|default:'rgb(101, 71, 150)' }}{% endblock %}
{% block body_color %}{{ body_color|default:'white' }}{% endblock %}
{% block body_text_color %}{{ body_text_color|default:'black' }}{% endblock %}
{% block custom_title_prop %}{% if title_logo %}style="background-size: auto 60%; background-position: 50%; background-repeat: no-repeat; background-image: url('/app_resource/{{ title_logo }}');"{% endif %}{% endblock %}
{% block title1 %}{{ title1 }}{% endblock %}
{% block title2 %}{{ title2 }}{% endblock %}
{% block custom_tools %}
{% endblock %}

{% block widget_content %} <!-- Main Start Block -->

<!-- File: display_host_urls.html
  Copyright (c) 2019 SlashNext Inc. (www.slashnext.com)

  Licensed under Apache 2.0 (https://www.apache.org/licenses/LICENSE-2.0.txt)
-->

<style>
.AppRunsWidget > .widget-wrapper {height: auto !important;}
*{margin: 0; padding: 0; box-sizing: border-box}
em{font-style: normal}
.temCont{margin:0 auto; max-width:1000px;width:100%;padding:0 10px}
.mainCont{font-family:'Roboto', sans-serif;font-size:13px;color:#424242;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}
.mainCont * {box-sizing:border-box;margin:0;padding:0}
.full,.mainCont section,.blockDiv,.blockHead,.blockRow,.blockRow span{float:left;width:100%;}
.cr-grey1{color:#535454!important;}
.cr-grey2{color:#424242!important;}
.cr-grey3{color:#7E7E7E!important;}
.cr-blue1{color:#4A90E2!important;}
.cr-red1{color:#D0021B!important;}
.cr-green1{color:#006400!important;}
.cr-orange1{color:#FFD700!important;}
.fs-17{font-size:17px!important}
.fs-13{font-size:13px!important}
.fs-11{font-size:11px!important}
.br-top-3{border-top:3px solid #535454;}
.br-gray{border:1px solid #D8D8D8;}
.br-gray-bottom{border-bottom:1px solid #D8D8D8;}
.br-gray-right{border-right:1px solid #D8D8D8;}
.br-gray-top{border-top:1px solid #D8D8D8!important;}
.bg-blue2{background:rgba(74,144,226,.15)!important;}
.bg-grey1{background:#535454!important;}
.bg-grey4{background:#EFEFEF!important;}
.bttn{margin-right: 15px; text-decoration:none;display:inline-block;background:#535454;height:40px;border-radius:4px;padding:0 15px;line-height:38px;border:1px solid #535454;font-size:13px;color:#fff!important;}
.bttn:hover{opacity: .8;}
.fw-500{font-weight:500!important}
.mb-5{margin-bottom:5px!important}
.mb-10{margin-bottom:10px!important}
.mb-15{margin-bottom: 15px!important}
.mb-20{margin-bottom: 20px!important}
.mb-30{margin-bottom: 30px!important}
.mt-20 {margin-top: 20px!important;}
.mb-20-red1{margin-bottom: color:#D0021B!important; 20px!important}
.mainCont h2{font-size: 17px!important;font-weight: 500!important;line-height: 31px!important}
.mainCont h3{font-size: 13px!important;font-weight: 400!important;line-height: 16px!important;word-break: break-all;}
.mainCont label{color: #7E7E7E!important;font-size: 11px!important;float: left;width: 100%;}
.blockDiv{float: left;border-left: 1px solid #D8D8D8;border-top:3px solid #535454;}
.blockHead div{float: left;padding: 10px 15px;border-right:1px solid #D8D8D8;border-bottom:1px solid #D8D8D8;}
.blockHead label{margin-bottom: 5px;}
.blockHead span {font-size: 13px;text-overflow: ellipsis;overflow: hidden; word-wrap: break-word;}
.blockHead2 div{width: 80%;}
.blockHead2 div:last-child{width: 20%;}
.blockRow div{float: left;padding: 10px 15px;border-right:1px solid #D8D8D8;border-bottom:1px solid #D8D8D8;}
.blockRow label{margin-bottom: 5px;}
.blockRow span {font-size: 13px;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;}
.blockRow4 div{width: 20%;}
.blockRow4 div:last-child{width: 40%;}
.blockRow5 div{width: 20%;}
.blockRow3 div{width: 33.33%;}
.blockRow2 div{width: 80%;}
.blockRow2 div:last-child{width: 20%;}
.img-enlarge img {cursor: nesw-resize;max-width: 100%;}
.popupContainer {position: fixed;width: 100%;height: 100%;background: rgba(255,255,255,.9);z-index: 99!important;display: none;left: 0;top: 0;text-align: center;overflow: auto;}
.popupContainer .crossIco {position: absolute;top: 100px!important;right: 100px!important;z-index!important: 100;color: #fff;background: #535454;width: 35px;height: 35px;text-align: center;line-height: 35px;border-radius: 50%;font-size: 25px;font-weight: bold;text-decoration: none;}
.popupContent {padding:200px 50px;}
.popupContent img {max-width: 100%;}
.full{margin-left:0!important;margin-right:0!important;}
@element .mainCont and (max-width: 700px) {
.mainCont .blockHead div {min-width: 100%;}
.mainCont .blockRow div {min-width: 100%;}
.mainCont .blockRow label{font-size: 10px!important;}
.mainCont .blockRow span{font-size: 12px!important}
div.mainCont h3 {font-size: 12px !important;}
div.mainCont h2 {font-size: 14px !important; line-height: 20px !important;}
.mainCont .blockHead {display: block;}
}
.blockHead {
	display: -webkit-flex;
    display: flex;
}
</style>

<div style="overflow: auto; width: 100%; height: 100%; padding-left:10px; padding-right:10px"> <!-- Main Div -->
	<div class="mainCont">

		{% for result in results %} <!-- Loop for each result -->

		<section class="mb-20 mt-20">
			<!-- Host Report section -->
			<h2 class="mb-10">SlashNext Phishing Incident Response - Host URLs</h2>

			<h3 class="mb-5">action = host urls</h3>
			<h3 class="mb-5">host = {{result.param.host}}</h3>

			{% if result.data.errorNo == 0 %} <!-- Host report success condition -->

			{% if result.data.normalizeData.normalizeStatus == 1 %}
			<!--h3 class="mb-5">host = {{result.param.host}}<em class="cr-blue1">*</em></h3-->
			<h3 class="mb-5 cr-blue1">*{{result.data.normalizeData.normalizeMessage}}</h3>
			{% endif %}

			{% if result.data.urlDataList.0.threatData.verdict == "Unrated, No Intel Found" %} <!-- No related URLs found -->
			<h3 class="mb-5">No entries found.</h3>
			{% else %} <!-- Certain related URLs found -->

			{% for urlData in result.data.urlDataList %} <!-- Loop for each found URL data -->
			<div class="blockDiv mb-15">
				<div class="blockHead blockHead2 bg-grey4">
					{% if urlData.threatData.verdict == "Malicious" %}
					<div><label>Scanned URL</label>
						<span>
							<a class="cr-red1" href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.url|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.url}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span class="cr-red1">{{urlData.threatData.verdict}}</span></div>
					{% elif urlData.threatData.verdict == "Benign" %}
					<div><label>Scanned URL</label>
						<span>
							<a class="cr-green1" href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.url|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.url}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span class="cr-green1">{{urlData.threatData.verdict}}</span></div>
					{% elif urlData.threatData.verdict == "Suspicious" %}
					<div><label>Scanned URL</label>
						<span>
							<a class="cr-orange1" href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.url|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.url}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span class="cr-orange1">{{urlData.threatData.verdict}}</span></div>
					{% else %}
					<div><label>Scanned URL</label>
						<span>
							<a href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.url|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.url}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span>{{urlData.threatData.verdict}}</span></div>
					{% endif %}
				</div>
				<div class="blockRow blockRow3">
					<div><label>Threat Status</label><span>{{urlData.threatData.threatStatus}}</span></div>
					<div><label>Threat Name</label><span>{{urlData.threatData.threatName}}</span></div>
					<div><label>Threat Type</label><span>{{urlData.threatData.threatType}}</span></div>
					<div><label>Scan ID</label>
						{% if urlData.scanId == "N/A" %}
						<span>{{urlData.scanId}}</span>
						{% else %}
						<span>
							<a href="javascript:;" onclick="context_menu(this, [{'contains': ['snx scan id'], 'value': '{{ urlData.scanId|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.scanId}}</a>
						</span>
						{% endif %}
					</div>
					<div><label>First Seen</label><span>{{urlData.threatData.firstSeen}}</span></div>
					<div><label>Last Seen</label><span>{{urlData.threatData.lastSeen}}</span></div>
				</div>

				{% if urlData.finalUrl %}
				<div class="blockRow blockRow2 bg-blue2">
					{% if urlData.threatData.verdict == "Malicious" %}
					<div><label>Final URL</label>
						<span>
							<a class="cr-red1" href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.finalUrl|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.finalUrl}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span class="cr-red1">{{urlData.threatData.verdict}}</span></div>
					{% elif urlData.threatData.verdict == "Benign" %}
					<div><label>Final URL</label>
						<span>
							<a class="cr-green1" href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.finalUrl|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.finalUrl}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span class="cr-green1">{{urlData.threatData.verdict}}</span></div>
					{% elif urlData.threatData.verdict == "Suspicious" %}
					<div><label>Final URL</label>
						<span>
							<a class="cr-orange1" href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.finalUrl|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.finalUrl}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span class="cr-orange1">{{urlData.threatData.verdict}}</span></div>
					{% else %}
					<div><label>Final URL</label>
						<span>
							<a href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.finalUrl|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.finalUrl}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span>{{urlData.threatData.verdict}}</span></div>
					{% endif %}
				</div>
				{% endif %}

				{% if urlData.landingUrl %}
				<div class="blockRow blockRow2 bg-blue2">
					{% if urlData.landingUrl.threatData.verdict == "Malicious" %}
					<div><label>Redirected URL</label>
						<span>
							<a class="cr-red1" href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.landingUrl.url|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.landingUrl.url}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span class="cr-red1">{{urlData.landingUrl.threatData.verdict}}</span></div>
					{% elif urlData.landingUrl.threatData.verdict == "Benign" %}
					<div><label>Redirected URL</label>
						<span>
							<a class="cr-green1" href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.landingUrl.url|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.landingUrl.url}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span class="cr-green1">{{urlData.landingUrl.threatData.verdict}}</span></div>
					{% elif urlData.landingUrl.threatData.verdict == "Suspicious" %}
					<div><label>Redirected URL</label>
						<span>
							<a class="cr-orange1" href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.landingUrl.url|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.landingUrl.url}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span class="cr-orange1">{{urlData.landingUrl.threatData.verdict}}</span></div>
					{% else %}
					<div><label>Redirected URL</label>
						<span>
							<a href="javascript:;" onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ urlData.landingUrl.url|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.landingUrl.url}}</a>
						</span>
					</div>
					<div><label>Verdict</label><span>{{urlData.landingUrl.threatData.verdict}}</span></div>
					{% endif %}
				</div>
				<div class="blockRow blockRow3">
					<div><label>Threat Status</label><span>{{urlData.landingUrl.threatData.threatStatus}}</span></div>
					<div><label>Threat Name</label><span>{{urlData.landingUrl.threatData.threatName}}</span></div>
					<div><label>Threat Type</label><span>{{urlData.landingUrl.threatData.threatType}}</span></div>
					<div><label>Scan ID</label>
						{% if urlData.landingUrl.scanId == "N/A" %}
						<span>{{urlData.landingUrl.scanId}}</span>
						{% else %}
						<span>
							<a href="javascript:;" onclick="context_menu(this, [{'contains': ['snx scan id'], 'value': '{{ urlData.landingUrl.scanId|escapejs }}' }], 0, {{ container.id }}, null, false);">{{urlData.landingUrl.scanId}}</a>
						</span>
						{% endif %}
					</div>
					<div><label>First Seen</label><span>{{urlData.landingUrl.threatData.firstSeen}}</span></div>
					<div><label>Last Seen</label><span>{{urlData.landingUrl.threatData.lastSeen}}</span></div>
				</div>
				{% endif %}
			</div>
			{% endfor %} <!-- Loop for each found URL data -->

			{% endif %} <!-- No related URLs found -->

			{% else %} <!-- Host report error condition -->
			<h3 class="mb-5 cr-red1">Error No: {{result.data.errorNo}}</h3>
			<h3 class="mb-5 cr-red1">Error Message: {{result.data.errorMsg}}</h3>
			{% endif %} <!-- Host report success condition -->

		</section>

	{% endfor %} <!-- Loop for each result end -->

	</div>
</div> <!-- Main Div -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/eqcss/1.9.2/EQCSS.min.js"></script>

{% endblock %} <!-- Main Start Block -->