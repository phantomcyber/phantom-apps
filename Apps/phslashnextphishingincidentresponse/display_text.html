{% extends 'widgets/widget_template.html' %}
{% load custom_template %}

{% block title_color %}{{ title_color|default:'white' }}{% endblock %}
{% block title_text_color %}{{ title_text_color|default:'rgb(101, 71, 150)' }}{% endblock %}
{% block body_color %}{{ body_color|default:'white' }}{% endblock %}
{% block body_text_color %}{{ body_text_color|default:'black' }}{% endblock %}
{% block custom_title_prop %}{% if title_logo %}style="background-size: auto 60%; background-position: 50%; background-repeat: no-repeat; background-image: url('/app_resource/{{ title_logo }}');"{% endif %}{% endblock %}
{% block title1 %}{{ title1 }}{% endblock %}
{% block title2 %}{{ title2 }}{% endblock %}
{% block custom_tools %}
{% endblock %}

{% block widget_content %} <!-- Main Start Block -->

<!-- File: display_text.html
  Copyright (c) 2019-2020 SlashNext Inc. (www.slashnext.com)

  Licensed under Apache 2.0 (https://www.apache.org/licenses/LICENSE-2.0.txt)
-->

<style>
.AppRunsWidget > .widget-wrapper {height: auto !important;}
*{margin: 0; padding: 0; box-sizing: border-box}
em{font-style: normal}
.temCont{margin:0 auto; max-width:1000px;width:100%;padding:0 10px}
.mainCont{font-family:'Roboto', sans-serif;font-size:13px;color:#424242;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}
.mainCont * {box-sizing:border-box;margin:0;padding:0}
.full,.mainCont section,.blockDiv,.blockHead,.blockRow,.blockRow span{float:left;width:100%;}
.cr-grey1{color:#535454!important;}
.cr-grey2{color:#424242!important;}
.cr-grey3{color:#7E7E7E!important;}
.cr-blue1{color:#4A90E2!important;}
.cr-red1{color:#D0021B!important;}
.cr-green1{color:#006400!important;}
.cr-orange1{color:#FFD700!important;}
.fs-17{font-size:17px!important}
.fs-13{font-size:13px!important}
.fs-11{font-size:11px!important}
.wf-h4-style{font-size:16px}
.br-top-3{border-top:3px solid #535454;}
.br-gray{border:1px solid #D8D8D8;}
.br-gray-bottom{border-bottom:1px solid #D8D8D8;}
.br-gray-right{border-right:1px solid #D8D8D8;}
.br-gray-top{border-top:1px solid #D8D8D8!important;}
.bg-blue2{background:rgba(74,144,226,.15)!important;}
.bg-grey1{background:#535454!important;}
.bg-grey4{background:#EFEFEF!important;}
.bttn{margin-right: 15px; text-decoration:none;display:inline-block;background:#535454;height:40px;border-radius:4px;padding:0 15px;line-height:38px;border:1px solid #535454;font-size:13px;color:#fff!important;}
.bttn:hover{opacity: .8;}
.fw-500{font-weight:500!important}
.mb-5{margin-bottom:5px!important}
.mb-10{margin-bottom:10px!important}
.mb-15{margin-bottom: 15px!important}
.mb-20{margin-bottom: 20px!important}
.mb-30{margin-bottom: 30px!important}
.mt-20 {margin-top: 20px!important;}
.mb-20-red1{margin-bottom: color:#D0021B!important; 20px!important}
.mainCont h2{font-size: 17px!important;font-weight: 500!important;line-height: 31px!important}
.mainCont h3{font-size: 13px!important;font-weight: 400!important;line-height: 16px!important;word-break: break-all;}
.mainCont label{color: #7E7E7E!important;font-size: 11px!important;float: left;width: 100%;}
.blockDiv{float: left;border-left: 1px solid #D8D8D8;border-top:3px solid #535454;}
.blockHead div{float: left;padding: 10px 15px;border-right:1px solid #D8D8D8;border-bottom:1px solid #D8D8D8;}
.blockHead label{margin-bottom: 5px;}
.blockHead span {font-size: 13px;text-overflow: ellipsis;overflow: hidden; word-wrap: break-word;}
.blockHead2 div{width: 80%;}
.blockHead2 div:last-child{width: 20%;}
.blockRow div{float: left;padding: 10px 15px;border-right:1px solid #D8D8D8;border-bottom:1px solid #D8D8D8;}
.blockRow label{margin-bottom: 5px;}
.blockRow span {font-size: 13px;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;}
.blockRow4 div{width: 20%;}
.blockRow4 div:last-child{width: 40%;}
.blockRow5 div{width: 20%;}
.blockRow3 div{width: 33.33%;}
.blockRow2 div{width: 80%;}
.blockRow2 div:last-child{width: 20%;}
.img-enlarge img {cursor: nesw-resize;max-width: 100%;}
.popupContainer {position: fixed;width: 100%;height: 100%;background: rgba(255,255,255,.9);z-index: 99!important;display: none;left: 0;top: 0;text-align: center;overflow: auto;}
.popupContainer .crossIco {position: absolute;top: 100px!important;right: 100px!important;z-index!important: 100;color: #fff;background: #535454;width: 35px;height: 35px;text-align: center;line-height: 35px;border-radius: 50%;font-size: 25px;font-weight: bold;text-decoration: none;}
.popupContent {padding:200px 50px;}
.popupContent img {max-width: 100%;}
.full{margin-left:0!important;margin-right:0!important;}
@element .mainCont and (max-width: 700px) {
.mainCont .blockHead div {min-width: 100%;}
.mainCont .blockRow div {min-width: 100%;}
.mainCont .blockRow label{font-size: 10px!important;}
.mainCont .blockRow span{font-size: 12px!important}
div.mainCont h3 {font-size: 12px !important;}
div.mainCont h2 {font-size: 14px !important; line-height: 20px !important;}
.mainCont .blockHead {display: block;}
}
.blockHead {
	display: -webkit-flex;
    display: flex;
}
</style>

<div style="overflow: auto; width: 100%; height: 100%; padding-left:10px; padding-right:10px"> <!-- Main Div -->
	<div class="mainCont">

		{% for result in results %} <!-- Loop for each result -->

			{% if not result.data %}
				<h4 class="wf-h4-style">No data found</h4>
			{% else %}
				<section class="mb-20 mt-20">
					<!-- Download Text section -->
					<h2 class="mb-10">SlashNext Phishing Incident Response - Download Text</h2>

					<h3 class="mb-5">action = download text</h3>
					<h3 class="mb-5">scan id = {{result.param.scanid}}</h3>

					{% if result.data.errorNo == 0 %} <!-- Download text success condition -->

						<div class="full"><a href="javascript:;" class="bttn download-text" id="txtDwlBnt{{ forloop.counter }}">Download Text</a></div>
						<script type="text/javascript">
							function downloadTxt(txtData,txtName) {
								return function() {
									var element = document.createElement('a');
									element.setAttribute('href', 'data:application/html;charset=utf-8,' + encodeURIComponent(txtData));
									element.setAttribute('download', txtName);
									element.style.display = 'none';
									document.body.appendChild(element);
									element.click();
									document.body.removeChild(element);
								};
							};
							var txtData = atob('{{result.data.textData.textBase64}}');
							var txtName = 'snx_' + '{{result.param.scanid}}' +'.txt';
							$("#txtDwlBnt" + "{{ forloop.counter }}").click(downloadTxt(txtData,txtName));
						</script>

					{% elif result.data.errorNo == 1 %} <!-- Download text pending condition -->
						<h3 class="mb-5">{{result.message}}</h3>
					{% else %} <!-- Download text error condition -->
						<h3 class="mb-5 cr-red1">Error No: {{result.data.errorNo}}</h3>
						<h3 class="mb-5 cr-red1">Error Message: {{result.data.errorMsg}}</h3>
					{% endif %} <!-- Download text success condition -->

				</section>
			{% endif %}

		{% endfor %} <!-- Loop for each result end -->

	</div>
</div> <!-- Main Div -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/eqcss/1.9.2/EQCSS.min.js"></script>

{% endblock %} <!-- Main Start Block -->
